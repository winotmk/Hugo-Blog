[{"content":" 一个轻量级MD文档收集博客，不保证阅读性\n使用树莓派+hexo构建，定制化next主题，github部署\n2023.9.8更新\n使用eci容器构建，自制镜像，cdn加速\n一些编辑的Tips:\n首页文章预览至：\n\u0026lt;!-- more --\u0026gt; markdown paste粘图：\nctrl+art+a 本站加速域名：https://md.winotmk.com/\n正式站：winotmk.com\n点击查看更多该网站更新日志\n2023.12.13更新\n为了防止忘记如何写这个博客，特留备忘\nNAS上工作台的盘符请设置为T\n启动ecistarter容器\n然后CD ecistart 进入目录\n使用. ./hexo_s 来脚本启动阿里云eci上的容器，此脚本包含如果一段时间内没有连接将会自动释放掉eci容器的功能，判断依据是是否有SSH接入\n之后通过VSCode的插件SSH FS来接入\nmd文档的目录是./hexo/Winblog/source/_posts\n关于图片插入：本地目录T:\\博客\\md_for_hexo\\Images将会与FTP上的./hexo/Winblog/source/images自动单向同步\n2024.06.17再更新\n因为买了阿里99服务器，改用了容器的形式运行\n启动组\ndocker compose -f hexo_debian_DockerCompose.yml up -d 关闭组\ndocker compose -f hexo_debian_DockerCompose.yml down -v\n同时配置了本地文章目录T:\\博客\\md_for_hexo_workspace和FTP上的./hexo/Winblog/source/_posts自动同步，终于不会存在本地和服务器上两份文章了\n在md_for_hexo_workspace写好后直接docker exec hexo hexo g -d即可发布\n2025.02.20再更新\n忽然发现阿里云OSS每个月要扣3块钱，才发现现在同城冗余和本地存储计价分开了，不能使用资源包扣容量了，本地存储的40G一年才几块钱却不起作用，傻傻交了好几个月的3块钱\n那么我忽然想到，现在是用SFTP插件同步本地目录完成上传图片到远程文件存储的，何不直接使用OSS呢，它不就是用来干这个的嘛，拿来做图床想必轻而易举，所以找到了一个插件来完成oss上传图片的工作\n还蛮好用的，绑定了elan upload from clipboard到ctrl+shift+alt+a来粘贴并上传文件到bucket，会按照当前文档名称建文件夹分类 vscode的账户真是太乱了，能用微软登录，能用github登，甚至能用微软里再用github登，今天统一为用github的550330147邮箱登录 ","date":"2023-12-13T00:00:00Z","image":"http://pictures.winotmk.com/20211101_005742_IMB_3iZZzg_ac4eb74c.gif","permalink":"http://localhost:10354/posts/winnote/","title":"WinNote"},{"content":"Hugo安装与建立新网站\r配置环境变量\r在这里下载打包好的二进制文件，单文件很方便\nhttps://github.com/gohugoio/hugo/releases\n要注意的是Hugo发行版分3种，标准版，extended扩展版，和代deploy功能的extended扩展版\n而Stack需要extended扩展版\n下好以后配置环境变量PATH到hugo单文件所在的目录，如果可以hugo version即说明它可以工作啦！\n建立一个新站点和Stack主题安装\rhttps://gohugo.io/getting-started/quick-start/\n我是直接新建一个目录到里面打开CMD，然后\nhugo new site .\r就会在本地生成好网站目录\n初始化git（因为需要用git子模块来拉主题的库）\ngit init\r然后加载子模块\ngit submodule add https://github.com/CaiJimmy/hugo-theme-stack/ themes/hugo-theme-stack\r主题文档参见：\nhttps://stack.jimmycai.com/guide/getting-started\nhttps://themes.gohugo.io/themes/hugo-theme-stack/\n好了，主题的安装文档居然到这里戛然而止了，令人十分费解，前期工作完成后，最后一步启用居然没说，Stack主题发的文档似乎十分希望用户使用这个库来直接开始用主题和hugo：\nhttps://github.com/CaiJimmy/hugo-theme-stack-starter\n但我偏不，我不喜欢预制用户用法的做法，我只是希望hugo作为一个生成器，部署要在阿里云OSS上做而不是github pages。\n所以摸索了大半天，自己安装的话应当将：\nthemes\\hugo-theme-stack\\exampleSite目录下的hugo.yaml文件复制到Hugo根目录并且删除原有的hugo.toml设置文件,注意不是themes\\hugo-theme-stack里的config.yaml\n如果你想看自带的示例文章可以将themes\\hugo-theme-stack\\exampleSite下的content覆盖到根目录的同名目录里\n之后就可以启动hugo预览了（不加-p参数默认端口为1313）\nhugo server -D -p 7512\r打开浏览器你将会看到：\n恭喜你，开始为博客填内容吧~\n","date":"2025-02-24T00:00:00Z","permalink":"http://localhost:10354/posts/250224_hugo%E5%AE%89%E8%A3%85%E5%92%8C%E5%90%AF%E7%94%A8%E4%B8%BB%E9%A2%98/","title":"Hugo安装和启用Stack主题"},{"content":"按照 https://brew.sh 这里的提示：\n/bin/bash -c \u0026quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026quot;\r装完brew后，敲brew居然不认得，还得我自己配一下\n所以：\ncd /opt/homebrew/bin/\rPATH=$PATH:/opt/homebrew/bin\r然后再\ncd ~/\rtouch .zshrc\recho export PATH=$PATH:/opt/homebrew/bin \u0026gt;\u0026gt; .zshrc\r这下就可以用brew啦，我主要是拿来\nbres install git\r安装git\n但是神奇的是当我后面再用vim ~/ .zshrc想看看它时却似乎打不开这个文件，难道mac的设置是一次性的生效就删\n","date":"2025-02-23T00:00:00Z","permalink":"http://localhost:10354/posts/250223_mac%E7%9A%84%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8homebrew%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/","title":"Mac的包管理器homebrew环境变量配置"},{"content":"1. 进入本地仓库目录\r打开终端（或 Git Bash），切换到仓库根目录：\ncd /path/to/your-repo\r2. 查看修改状态\r检查哪些文件被修改：\ngit status\r红色显示的文件表示已修改但未添加到暂存区。 3. 将修改添加到暂存区\r添加单个文件：\ngit add 文件名\r或添加所有修改的文件：\ngit add .\r再次运行 git status，绿色显示的文件表示已添加到暂存区。\n4. 提交修改到本地仓库\rgit commit -m \u0026quot;描述你的修改内容（例如：修复登录页面样式问题）\u0026quot;\r-m 后跟提交信息，需简洁明确（推荐使用英文或中文）。 5. 推送修改到远程仓库\r将本地提交推送到远程仓库（默认分支通常是 main 或 master）：\ngit push origin 分支名\r例如推送到 main 分支： git push origin main\r6. 验证推送结果\r访问远程仓库页面（如 GitHub），检查文件是否更新。 或通过命令查看远程状态： git log --oneline # 查看本地提交记录\rgit remote show origin # 检查远程仓库状态\r常见问题\r提交后发现漏了文件：\n# 继续修改文件，然后再次添加并提交\rgit add 漏掉的文件名\rgit commit --amend # 合并到上一次提交\rgit push -f origin 分支名 # 强制推送（仅限自己的分支）\r推送冲突（多人协作时可能发生）：\ngit pull origin 分支名 # 先拉取远程最新代码，解决冲突后再推送\r默认情况下直接使用 git clone 不会自动克隆子模块（submodule）。子模块信息虽然记录在 .gitmodules 文件中，但其代码需要额外操作才能同步到本地。\n如何完整克隆包含子模块的仓库？\r方法 1：递归克隆（推荐）\r在克隆时添加 --recurse-submodules 参数，一次性递归克隆主仓库和所有子模块：\ngit clone --recurse-submodules 仓库URL\r方法 2：克隆后初始化子模块\r如果已经用普通方式克隆了主仓库，后续可以手动拉取子模块：\n# 进入主仓库目录\rcd your-repo\r# 初始化子模块配置（从 .gitmodules 读取）\rgit submodule init\r# 拉取子模块代码\rgit submodule update\r# 或者合并成一步：\rgit submodule update --init\r验证子模块\r查看子模块目录是否包含文件（不再是空文件夹）：\nls -la path/to/submodule\r检查子模块状态：\ngit submodule status\r常见问题\r子模块更新失败：\n确保子模块的仓库地址可访问（尤其是私有仓库）。 如果子模块本身也有嵌套子模块，使用： git submodule update --init --recursive\r切换分支后子模块内容异常：\n主仓库切换分支时，子模块可能需要同步更新到对应提交：\ngit submodule update --remote\r子模块工作原理\r主仓库只记录子模块的具体提交哈希，不保存子模块的代码。 子模块是独立的仓库，需要单独拉取和更新。 设置代理\rgit config \u0026ndash;global http.proxy http://127.0.0.1:7080\ngit config \u0026ndash;global https.proxy https://127.0.0.1:7080\n取消设置代理\ngit config \u0026ndash;global \u0026ndash;unset http.proxy\ngit config \u0026ndash;global \u0026ndash;unset https.proxy\n可以通过\ngit config -l\n查看设置状态\n","date":"2025-02-21T00:00:00Z","permalink":"http://localhost:10354/posts/250221_git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","title":"Git常用命令"},{"content":"整了大半天，总算明白GithubAction是怎么用的了，给人感觉其实有那么些像docker，而需要为其写的action规则又像dockerfile或者dockercompose，它们都是去调用一些已经做好的功能/镜像，来按步骤去一步步达成一些事\n参考文章：\nhttps://thooooor.github.io/posts/%E8%84%B1%E5%9D%91%E8%AE%B0%E5%BD%95/hugo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/\nhttps://kingtuo123.com/posts/hugo-deploy/\nhttps://zhuanlan.zhihu.com/p/367426039\n参考链接\raction：\nhttps://github.com/manyuanrong/setup-ossutil\nhttps://github.com/peaceiris/actions-hugo\nhugo和其主题：\nhttps://gohugo.io/getting-started/quick-start/\nhttps://github.com/adityatelange/hugo-PaperMod\n当你通过 git push 触发 GitHub Actions 流程时，需要将 Hugo 博客的源代码推送到仓库。以下是具体操作步骤和本地准备：\n一、本地准备工作\r1. 项目结构要求\r你的本地 Hugo 博客项目需要包含以下内容：\nyour-blog-repo/\r├── .github/workflows/deploy.yml # 你的 GitHub Actions 配置文件\r├── content/ # 博客文章\r├── themes/ # Hugo 主题（通常作为 Git 子模块）\r├── config.toml # Hugo 配置文件\r└── (其他 Hugo 相关文件)\r2. 本地环境配置\r安装 Git：确保已安装 Git 并配置好 GitHub 账户。 安装 Hugo（可选）：\n建议本地安装 Hugo 用于测试（与 Actions 中版本一致）： brew install hugo # macOS\r# 或参考 Hugo 官方文档 https://gohugo.io/installation/\r3. 初始化 Git 仓库\rcd your-blog-repo\rgit init\rgit remote add origin https://github.com/你的用户名/你的仓库名.git\r4. 处理子模块（主题）\r如果使用了 Hugo 主题（如通过 Git 子模块添加）：\n# 示例：添加主题为子模块\rgit submodule add https://github.com/主题作者/主题仓库.git themes/主题名\r确保 .gitmodules 文件已提交。\n二、触发 Actions 的 Push 内容\r你需要将以下内容推送到 GitHub 仓库：\nHugo 源文件\nconfig.toml（Hugo 配置） content/（文章） themes/（主题，通常以子模块形式存在） archetypes/、static/ 等其他 Hugo 所需文件 GitHub Actions 配置文件\n确保 .github/workflows/deploy.yml 文件存在于仓库中。\n不包含生成的文件\n不要推送 public/ 目录（Hugo 生成的静态文件会被 Actions 自动构建）。\n三、操作流程示例\r1. 本地修改并测试\r# 本地生成静态文件测试（可选）\rhugo server -D # 启动本地预览\r2. 提交代码\rgit add .\rgit commit -m \u0026quot;更新博客内容\u0026quot;\r3. 推送到 GitHub\rgit push -u origin main # 假设主分支是 main\r4. 触发 Actions\r推送后，到 GitHub 仓库的 Actions 标签页查看运行状态。\n若流程成功，阿里云 OSS 的存储桶中会自动出现 public/ 的内容。\n四、关键注意事项\r分支匹配\n确保工作流配置中的 push 事件分支（默认所有分支）与你推送的分支一致。\n（若需限制分支，可在配置中指定：on.push.branches: [main]）\n密钥安全\n阿里云的 OSS_KEY_ID 和 OSS_KEY_SECRET 必须通过 GitHub 仓库的 Settings → Secrets 添加，不要明文写在代码中。 子模块更新\n如果主题子模块有更新，需在本地执行：\ngit submodule update --remote --merge\rgit add themes/主题名\rgit commit -m \u0026quot;更新主题\u0026quot;\r调试失败问题\n若 Actions 运行失败，检查日志中的报错信息（如 Hugo 版本冲突、OSS 权限不足等）。 本地可通过 hugo --minify 命令预验证构建是否正常。 五、流程图解\r本地修改博客内容 → 提交并推送 → GitHub 触发 Actions → 自动构建 Hugo → 上传到 OSS\r（无需手动操作部署）\r通过这种方式，你只需专注于内容创作和本地代码修改，部署过程会完全自动化。\n其他\rhexo的GithubAction自动部署，用了两个仓库——github.io与hexo项目仓库区分操作\nhttps://hackergavin.com/2024/01/11/hexo-automate-deploy/#%E5%88%9B%E5%BB%BA-Github-Actions-%E8%84%9A%E6%9C%AC\n另外一种hexo部署\nhttps://cloud.tencent.com/developer/article/2369534\n","date":"2025-02-20T00:00:00Z","permalink":"http://localhost:10354/posts/250221_hugo_githubaction%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91oss/","title":"Hugo_GithubAction自动部署到阿里云OSS"},{"content":"我要先吐槽一下是真麻烦，以前一年续签一次的免费证书多好，和服务器续费周期一致，一年维护一次就好了，现在搞得像交房租，每季度都要维护，听说Let’s Encrypt上可以发免费证书，然后通过类似Certbot或者httpsok来自动获取和部署，回头再研究了，似乎我用的这种老式虚拟云主机不能整这个，回头想换成容器服务，这官网价格一年500是逼着你转型网站服务器的节奏\n获取新的证书\r阿里云SSL证书管理\n这里点个人测试证书，然后申请域名winotmk.com与md.winotmk.com\n部署证书\r部署全站加速的证书\r由于都是一个号里买的阿里云的产品，所以可以一键部署\n部署到别的平台\r先下载证书，点更多\n这里选下载tab，下载第一个pem/key格式的证书即可，解压下来会是两个文件\nwinotmk.com 是我在新万网买的，所以这里登录后台\nwww.xinwanwang.com/login.asp\n用他给的管理员账号密码在控制面板里登录\n登录上以后在域名绑定这里选关闭强制http访问再打开，把刚才下载下来的证书密钥文件两个分别复制到对话框里即可完成部署啦！\n","date":"2025-02-20T00:00:00Z","permalink":"http://localhost:10354/posts/250220_ssl%E8%AF%81%E4%B9%A6%E6%89%8B%E5%8A%A8%E6%9B%B4%E6%96%B0/","title":"SSL证书手动更新"},{"content":"投影仪侧解码的软件\rhttps://www.zhihu.com/tardis/zm/art/408177850\nKODI软件，可以直接这里\nhttps://kodi.tv/download/android/\n下载到能直接安装的软件，试了极米的投影可直接装，然后要设置nas的文件目录，从而通过局域网读取视频文件，显然这是通过投影里解码的，卡得飞起，很快就出现了音话不同步的问题\nnas解码的软件\r群晖自己有video station，有nas内的软件，也提供客户端，还有专为tv提供的软件：\nhttps://www.synology.cn/zh-cn/support/download/DS720+?version=7.2#androids\n但是这里的tv版装会出现装完了但是会有看不到图标的问题，多半是因为极影用的安卓并不是安卓tv而是魔改的安卓，所以要使用群晖的这个客户端，要么自己重新编一下\nhttps://blog.csdn.net/hx7013/article/details/103764083\n要么下这个改过入口app的软件——DSVideo GO!，配合群晖官方的客户端即可使用!\nhttp://nasyun.com/thread-63924-1-1.html\n","date":"2025-01-28T00:00:00Z","permalink":"http://localhost:10354/posts/250128_%E6%8A%95%E5%BD%B1%E6%94%BEnas%E8%B5%84%E6%BA%90/","title":"投影仪推nas"},{"content":"泰香辣，24年10月31，入了垂涎已久的macbook air M3，之前买的m1pro的macbookpro给了女票剪视频用了，自己平常用台式还是想入个轻便的本本，然后补贴价格入的，真香真香\n现在的mac下截图有Longshot（和win下的snipaste完全平替），vscode也一样的用，svn也很好使，群晖nas上的也很好使，还能iphone投屏了！很适合带到图书馆公司里，开盖就做点东西用，重要的是重量和大小，仿佛一个大号的ipad但是x86pc能做的基本都可以做~\n","date":"2024-10-31T00:00:00Z","permalink":"http://localhost:10354/posts/241031_%E6%96%B0mac/","title":"新的macbook air"},{"content":"方法一：开SMB文件服务再映射端口\r在这里打开SMB\n然后在路由器里打开端口转发，需要137-139,445这么几个端口，我是路由拨号已有公网IP\n这样的好处就是相对简单，不需要客户端再装软件windows自带即可连接，当然需要NAS有公网IP（或者再做穿透）\n缺点：坏处就是，这个几个端口似乎非常不安全，在我转发这几个端口后，可以看到一直有IP尝试钻进来被NAS封，而且如果想要改这几个端口似乎不是那么容易的懒得研究啦\n某天在公司忽然死活连不上后（内网还可以访问，说明SMB服务没问题，也许被运营商封端口了？），尝试另一种访问文件的方法\n方法二：WeaDAV+RaiDrive客户端\r首先NAS上装WeaDAV，设置一下：\n路由器里转发这俩端口就可以\n然后pc安装RaiDrive这个软件，设置如下：\n即可成功挂载一个带盘符的网络驱动器，试了下稳定性还是不错的，速度和SMB无异，用起来也没啥区别\n缺点：开机得启动RaiDrive这个软件，而且似乎读不了正确的NAS容量大小（500g是我自己填的)\n","date":"2024-10-08T00:00:00Z","permalink":"http://localhost:10354/posts/241008_%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE%E7%BE%A4%E6%99%96nas%E7%9A%84%E6%96%87%E4%BB%B6/","title":"外网访问群晖NAS的文件"},{"content":"在用johngong/calibre-web:latest这个镜像 https://hub.docker.com/r/johngong/calibre-web\n作为自己nas上的图书馆时发现pdf文件无法生成封面，\n断断续续排查了两周，百思不得解，尝试过：\n设置imagemagick的policy.xml文件(/etc/Imagemagick/policy.xml) 使用lscr.io/linuxserver/calibre-web:latest的镜像 自己重新构建镜像 重新安装calibre-web包和重装imagemagick包\n都解决不了，总之是十分折腾，最后认为可能是johngong/calibre-web:latest可能是里少了一个imagemagick-pdf包 最终有效的解决方法的折腾流程\r我尝试上传pdf文件，然后打开日志（日志级别设置为DEBUG）\n查看文件：/config/calbre-web/calbre-web.log\n有这么一行：\n[2024-09-25 12:10:22,144] WARN {cps.uploader:237} Cannot extract cover image, using default: no decode delegate for this image format `PDF' @ error/constitute.c/ReadImage/746\r[2024-09-25 12:10:22,145] WARN {cps.uploader:238} On Windows this error could be caused by missing ghostscript\rPDF转就转不出来\n所以找到了：\nhttps://github.com/ImageMagick/ImageMagick/issues/6148\napk add --no-cache imagemagick imagemagick-pdf\r安装完以后，再次尝试上传pdf格式的书，就看见封面辣！！\njohngong/calibre-web的一些设置\rhttps://github.com/gshang2017/docker/issues/133\n如果一编辑图书的元数据就卡死，可用尝试：\n这两条设置为true,则\n这里不会出现google等选项，家里的nas没有梯子环境，反而会导致卡死，所以禁用google吧。。也没啥用\n弯路\r这里想记一下这个弯路，在calibre-web的FAQ里赫然记着有关pdf文件转不出封面的解决办法，说要改\nhttps://github.com/janeczku/calibre-web/wiki/FAQ#what-to-do-if-cover-pictures-are-not-extracted-from-pdf-files\n所以可以有/etc/Imagemagick/policy.xml:\n\u0026lt;policymap\u0026gt;\r\u0026lt;policy domain=\u0026quot;coder\u0026quot; rights=\u0026quot;read | write\u0026quot; pattern=\u0026quot;{MSVG,MVG,PS,PDF,RSVG,SVG,XPS}\u0026quot; /\u0026gt;\r\u0026lt;/policymap\u0026gt;\r这是最容易找到的一种解法，但我自己试了无用，没有上面的装apk add imagemagick-pdf好使\n尝试出来的另一种PDF封面提取可行方法\r这样做出来的calibre-web镜像可以实现PDF转换，但是没有电子书格式转换，没有禁用google元数据搜索，没有中文环境，懒得自己做了，还是修修用johngong/calibre-web包吧\n为了试验，我用FROM ubuntu:latest作为镜像基底，然后：\n装calibre-web\r安装calibre-web：\nhttps://github.com/janeczku/calibre-web?tab=readme-ov-file#installation\nhttps://github.com/janeczku/calibre-web/wiki/Dependencies-in-Calibre-Web-Linux-and-Windows\n这里也有提到\nhttps://chenjiehua.me/others/calibre-web-personal-book-store.html\npip install calibreweb\rpip install calibreweb[metadata]\r装imagemagick\r然后安装imagemagick\n官方：\nhttps://imagemagick.org/script/download.php\n也有提到：\nhttps://www.cnblogs.com/echohye/p/17727865.html\napt install imagemagick\r装完后convert和magick命令应当是可用的\n手动装imagemagick\r或者我用上面官方的magick文件手动配貌似也行：\n先把magick文件放入根目录\n./magick --appimage-extract\rhttps://docs.appimage.org/user-guide/troubleshooting/fuse.html\n提到了可以用--appimage-extract直接释放出软件包来\n会发现释放出来文件在/squashfs-root目录里\n设置环境变量：\nexport MAGICK_HOME=\u0026quot;/squashfs-root/usr\u0026quot;\rexport PATH=\u0026quot;$MAGICK_HOME/bin:$PATH\u0026quot;\rexport LD_LIBRARY_PATH=\u0026quot;${LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:}$MAGICK_HOME/lib\u0026quot;\r然后imagemagick应该就能用了。。\n其他\rlscr.io/linuxserver/calibre-web:latest\n这个镜像也不小，但功能还算完整，上传pdf可直接显示封面，但不是中文环境，而且部署到我的nas上后死活传不了新书说什么无法写入，懒得深究了，弃之\n","date":"2024-09-25T00:00:00Z","permalink":"http://localhost:10354/posts/240925_calibre_web%E7%9A%84pdf%E5%B0%81%E9%9D%A2%E6%8F%90%E5%8F%96%E9%97%AE%E9%A2%98/","title":"calibre_web的pdf封面提取问题"},{"content":"最近找到个整合包（因为懒得一个个翻bbs\nhttps://www.bilibili.com/read/cv7403697/?spm_id_from=333.999.collection.opus.click\n这包里的mod和之前自己开的服务器高度相似，太棒啦，从1.7.10直升1.12.2，基本还都是熟悉的味道\n才知道mcbbs已经无了，然后才可发现mc百科已经这么好用了，连接直连发布curseforge和github，省去搬运步骤，也蛮好的！\n服务端有了，想通过docker容器部署到我的群晖NAS上，DS720+扩容了根16G内存条放着也是放着\n选取docker镜像\rdocker hub里有官方镜像，用的是这个，体积精简，只运行环境jre就够了\nhttps://hub.docker.com/_/openjdk/tags?page=1\u0026page_size=\u0026name=8u342\u0026ordering=\n所以直接\ndocker pull openjdk:8u342-jre-slim\r然后直接这样运行就好了\ndocker run -it -d \\\r-p 25565:25565 \\\r-v E:\\game\\MC\\1.12.2mohist_服务端:/mc \\\r-w /mc \\\r--name MC1122 \\\ropenjdk:8u342-jre-slim \\\rjava -Xms2G -Xmx8G -XX:+UseG1GC -XX:+AggressiveOpts -XX:+UseCompressedOops -jar Mohist-1.12.2-c950429-server.jar nogui\r虽然长，但是总的来说挺简单，用openjdk:8u342-jre-slim镜像运行java命令罢了，但是！\n出现了一个人让人感觉不爽的小问题，服务端的log输出以及游戏内服务端来的输出都是英文的，这在之前直接windows运行时不是这样的，所以第一反应是语言环境问题\n设置环境变量\r在docker run的时候加上个参数-e LANG=\u0026quot;zh_CN.UTF-8\u0026quot;，类似export LANG=zh_CN.UTF-8\n确定环境变量生效了：\n但没解决问题，反而似乎导致启动的时候不认识中文的mod文件名了\n在查找这个之后：docker 容器设置中文环境\n发现单纯设置LANG的变量不行，容器里就没有中文字符集的\n查看已有语言\rlocale -a\r安装中文环境\r使用DockerFile的方式快速构建一个基础镜像，解决中文环境问题\n所以安装中文环境的命令可以是：\napt-get install -y language-pack-zh-hans\r但这样不行！因为这个是ubuntu的命令，查看我的docker镜像的信息发现是以debian基底的\n看到:Debian系统安装中文包\ndpkg-reconfigure locales\r然后再选zh_CN.UTF-8，可行，但是集成到镜像里没那么好使，还好有别的方法\n制作新镜像\r参考：dockerfile文件中给debian设置中文支持\ndockerfile\rFROM openjdk:8u342-jre-slim\rRUN apt-get clean \u0026amp;\u0026amp; apt-get update \u0026amp;\u0026amp; apt-get install -y locales \u0026amp;\u0026amp; localedef -c -f UTF-8 -i zh_CN zh_CN.utf8\rWORKDIR /mc\rENV LANG zh_CN.UTF-8\r保存为dockerfile文件然后\ndocker build -t jre8u342_ch .\r测试运行\rdocker run -it -d \\\r-p 25565:25565 \\\r-v E:\\game\\MC\\1.12.2mohist_服务端:/mc \\\r--name MC1122 \\\rjre8u342_ch:latest \\\rjava -Xms2G -Xmx8G -XX:+UseG1GC -XX:+AggressiveOpts -XX:+UseCompressedOops -jar Mohist-1.12.2-c950429-server.jar nogui\r因为dockerfile里已经设置过WORKDIR了所以不需要-w参数\n这下不会报英文了\n游戏里也是中文环境的返回信息\n部署到群晖\r先把做好的镜像打包出来，方便传到群晖NAS里\ndocker save -o jre8u342_ch.tar jre8u342_ch:latest\r先导入这个镜像\n然后简单配置一下端口和mc服务器目录就可以了,和上面的docker run其实是一样的\n端口的25565是游戏端口25575用作管理，下面会提到\n服务器远程管理\r用容器托管运行了，上哪去敲/op xxxx和/stop之类的管理命令呢？\n可以用rcon方案！\nhttps://wiki.vg/RCON\n具体就是用这个软件：\nhttps://github.com/Tiiffi/mcrcon\n安装和服务端配置：\rgit clone https://github.com/Tiiffi/mcrcon.git\rcd mcrcon\rmake\rsudo make install\r然后服务端也要配置一下，在server.properties里的\nenable-rcon=false\r改为\nenable-rcon=true\rrcon.password=your_passwd\rrcon.port=25575\r用法：\r先连接\nmcrcon -H 服务器地址 -p your_passwd\r然后就可以一样敲各种minecraft管理命令了\n好了不说了博主我要去挖矿开荒了\n参考\rdebian文档，第 8 章 国际化和本地化：\nhttps://www.debian.org/doc/manuals/debian-reference/ch08.zh-cn.html#_rationale_for_utf_8_locale\n类似的打包好的docker环境MC服务器镜像有：\nhttps://github.com/itzg/docker-minecraft-server/tree/master\n对我来说功能有点多，只是参考参考\n","date":"2024-08-15T00:00:00Z","permalink":"http://localhost:10354/posts/240815_%E7%BB%99docker%E5%AE%B9%E5%99%A8%E5%86%85%E9%85%8D%E7%BD%AE%E4%B8%AD%E6%96%87%E7%8E%AF%E5%A2%83/","title":"给docker容器内配置中文环境(minecraft开服相关)"},{"content":"问题:\n例如\nprint(\u0026quot;位置过期:%-6.0f秒\u0026quot;%cachetime)的%-6.0f是什么意思？\n%-6.0f里的每一个字符都是有意义的\n在 Python 中，%-6.0f 是一种格式化字符串的方法，用于格式化浮点数 cachetime 的值。让我们来逐部分解释：\n解释\r%：\r% 是格式化操作符，用于将后面指定的变量格式化并插入到字符串中。\n-6：\r-6 是一个宽度说明符，它指定了格式化后输出的最小宽度为 6 个字符。\n- 表示左对齐。如果没有这个符号（即为默认的右对齐），数字会向右对齐。\n如果数字宽度不足 6 个字符，则会在数字右侧补充空格，以达到 6 个字符的总宽度。\n.0：\r.0 指定了浮点数的小数部分显示 0 位（即不显示小数部分）。因此，浮点数会被显示为整数形式。\nf：\rf 表示将变量作为浮点数进行格式化。\nps:如果不用格式化字符串，直接print(cachetime)会报错，因为不能直接打印浮点数，可以print(str(cachetime))\n例子\r假设 cachetime 的值是 820.75，则：\ncachetime = 820.75\rformatted_string = u\u0026quot;位置过期:%-6.0f秒\u0026quot; % cachetime\rprint(formatted_string)\r输出：\n位置过期:821 秒\r输出解释：\r%-6.0f 将 820.75 格式化为 821（由于 .0 不显示小数部分）。\n821 左对齐，占用至少 6 个字符的位置。如果 821 只有 3 个字符，右边会填充 3 个空格，使得总宽度为 6 个字符。\n如果你将数字换成更小的，比如 10：\ncachetime = 10\rformatted_string = u\u0026quot;位置过期:%-6.0f秒\u0026quot; % cachetime\rprint(formatted_string)\r输出：\n位置过期:10 秒\r10 会左对齐，后面会补充 4 个空格，使总长度达到 6 个字符。\n","date":"2024-08-10T00:00:00Z","permalink":"http://localhost:10354/posts/240810_python%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%96%B9%E6%B3%95/","title":"python格式化字符串的方法"},{"content":"其实自己很长一段（接下来将来可能也会）时间内有两个网站，一个是习惯稍微正式点的东西写在：\nhttps://www.winotmk.com/\n是我的第一个网站，基于wordpress的，买的包年虚拟服务器，但很多内容年久失修，而且刚架设的时候什么也不知道，一点点摸通服务器，备案，注册域名之类的，那会儿还挺流行wordpress，似乎也没有别的更多的选择\n同时还有一个\nhttps://md.winotmk.com/\n(https://winotmk.github.io/)\n由hexo驱动的纯静态md文档网站，比较随意，想到啥写啥，构建方式也比较特别，是运行在云服务的容器里，静态文章则是在阿里云nas存储里，网站生成后托管在github，同时cdn加速\n似乎md站可以用更放松的心情去记录，慢慢的文章比主站还多了？！\n因为目前主站的各种小毛病（也不是不能用）所以经常考虑要不要把它换套别的结构，网上一搜确实有比如一键wordpress转hugo的方案，总之先记着，不一定用。因为当初20块买了套便宜的wordpress皮肤，然后在此基础上魔改各种css，已然改成了忒修斯之船，全丢弃了还是挺可惜的（沉没成本2333\n网站生成/框架\rtypecho\rTypecho 是一款基于 PHP 的博客软件，旨在成为世界上最强大的博客引擎\nhttps://github.com/typecho/typecho\nhttps://typecho.org/\n这个好在和wordpress一样也是PHP的，想必能很快的迁移过来吧，而且目测更轻量，就是可能还是得租虚拟服务器了\n预览博客：\nhttps://xhhdd.cc/index.php/archives/27/\nhttps://cfanlost.com/\nhugo\rhttps://gohugo.io/\n似乎是类hexo生成静态网页，然后可以塞到github托管的\npelican\rPelican 是一个用Python编写的静态站点生成器，允许您通过编写 Markdown、reStructuredText 和 HTML 等格式的文本文件来创建网站\nhttps://github.com/getpelican/pelican\n听起来类似hexo和hugo，只是一个nodejs，一个go，这个则是python做的（真好啊\njekyllrb\r将纯文本转换为静态网站和博客\nhttps://jekyllrb.com/\n应该和上面类似，同样是静态文章生成，部署到github\n预览博客：https://jaminzhang.github.io/linux/Change-Linux-System-Locale-Envs/\n皮肤/主题\rtypecho\rhandsome\rhttps://www.ihewro.com/archives/489/\npelican\rattila\rhttps://github.com/arulrajnet/attila\n预览博客：https://leonis.cc/sui-sui-nian/2023-10-31-cloudflare-dns-of-blog.html\nhugo\rPaperMod\rhttps://themes.gohugo.io/themes/hugo-papermod/\nDemo:https://adityatelange.github.io/hugo-PaperMod/\n评论系统\rwaline\rhttps://github.com/walinejs/waline\nutterances\r是一个基于GitHub issues的轻量级评论，用github登录\nhttps://utteranc.es/\n","date":"2024-08-06T00:00:00Z","permalink":"http://localhost:10354/posts/240806_%E7%BD%91%E7%AB%99%E6%A1%86%E6%9E%B6%E6%94%B6%E9%9B%86/","title":"网站框架收集"},{"content":"硬件简介\r屏幕\r屏幕使用了一块微雪的电子墨水段码屏\n文档在这里：\nhttps://www.waveshare.net/wiki/1.9inch_Segment_e-Paper_Module_Manual\nMCU\rMCU方面就是树莓派的PICO，只不过是物理体积更小的版本，用法是一模一样的\nhttps://www.waveshare.net/wiki/RP2040-Zero\n字节(byte)和比特(bit)的对应\r最近买了块高颜值段码屏，电子墨水屏原理的，一直没弄明白这个文档里说得是个啥意思，恰好最近尝试使用GPT来解决我遇到的一些编程问题，\n本来只是抱着试试看的态度，因为自从chatgpt火了以后一直持观望态度，印象中还只是能给它设定模仿人格写写小说一类的，然而这次实在小震撼到我\n起初这个表对于完全没接触过这块的我完全不动他是什么意思\n疑惑的关键在于0x00怎么就全0，而0xff怎么就全1了呢，于是我问GPT：\n*以下是GPT的回答\n在这个图表中，每个字节（byte）由 8 个比特（bit）组成，且每个比特都可以存储一个二进制值（0 或 1）。这些比特在图像中对应的像素（pixel）上，决定了每个像素的颜色（例如，黑色或白色）。\n理解图表中的内容\r像素 (pixel): 从 1 到 16 的编号表示每个像素的位置。 比特 (bit): 每个像素位置对应一个比特，从 7 到 0 代表一个字节中的每一位。 存储的数据: 存储在比特中的数据值（0 或 1）。 对应的颜色: 由数据值决定的像素颜色（黑色或白色）。\n5。 字节 (byte): 0x00 和 0xff 表示字节的十六进制值。 字节和比特的对应关系\r一个字节有 8 位，每一位可以是 0 或 1。 0x00 表示 8 个比特全部为 0，转换为二进制是 00000000。 0xff 表示 8 个比特全部为 1，转换为二进制是 11111111。 解释示例\r0x00 字节: 二进制表示：00000000 每个比特位都是 0，因此对应的像素颜色是黑色。 从像素 1 到 8 的存储数据都是 0，所以对应颜色都是黑色。 0xff 字节: 二进制表示：11111111 每个比特位都是 1，因此对应的像素颜色是白色。 从像素 9 到 16 的存储数据都是 1，所以对应颜色都是白色。 示例代码解释\r如果你想用代码来解释字节和比特之间的关系，可以如下示例：\n# 示例字节\rbyte_00 = 0x00 # 所有比特位都是 0\rbyte_ff = 0xff # 所有比特位都是 1\r# 打印二进制表示\rprint(f\u0026quot;0x00 的二进制表示: {bin(byte_00)[2:].zfill(8)}\u0026quot;)\rprint(f\u0026quot;0xff 的二进制表示: {bin(byte_ff)[2:].zfill(8)}\u0026quot;)\r# 转换为像素颜色\rpixels_00 = [\u0026quot;■\u0026quot; if bit == '0' else \u0026quot;□\u0026quot; for bit in bin(byte_00)[2:].zfill(8)]\rpixels_ff = [\u0026quot;■\u0026quot; if bit == '0' else \u0026quot;□\u0026quot; for bit in bin(byte_ff)[2:].zfill(8)]\rprint(f\u0026quot;0x00 对应的像素颜色: {''.join(pixels_00)}\u0026quot;)\rprint(f\u0026quot;0xff 对应的像素颜色: {''.join(pixels_ff)}\u0026quot;)\r输出\r复制代码\r0x00 的二进制表示: 00000000\r0xff 的二进制表示: 11111111\r0x00 对应的像素颜色: ■■■■■■■■\r0xff 对应的像素颜色: □□□□□□□□\r在这里，■ 表示黑色像素，□ 表示白色像素。这个代码示例展示了如何根据字节中的比特值确定像素颜色。\n天呐！有理有据条例清晰，秒懂了，原来byte是十六进制要转为二进制的！而8位二进制就可以表示8个数码管的开与关了！\n数字显示与byte的对应\r*GPT回答：\n为了将数字 23.8 和 54.9 表示为 DSPNUM_1in9_off 数组中的十六进制值，我们需要将每一位数字对应的十六进制编码放入数组的正确位置。根据你提供的映射：\n0 ：0xbf, 0x1f\n1 ：0x00, 0x1f\n2 ：0xfd, 0x17\n3 ：0xf5, 0x1f\n4 ：0x47, 0x1f\n5 ：0xf7, 0x1d\n6 ：0xff, 0x1d\n7 ：0x21, 0x1f\n8 ：0xff, 0x1f\n-9 ：0xf7, 0x1f\n根据你的要求：\n数字 A 为 23.8\n十位 2 对应 DSPNUM_1in9_off[1] 和 DSPNUM_1in9_off[2] 个位 3 对应 DSPNUM_1in9_off[3] 和 DSPNUM_1in9_off[4] 小数点后一位 8 对应 DSPNUM_1in9_off[11] 和 DSPNUM_1in9_off[12] 数字 B 为 54.9\n十位 5 对应 DSPNUM_1in9_off[5] 和 DSPNUM_1in9_off[6] 个位 4 对应 DSPNUM_1in9_off[7] 和 DSPNUM_1in9_off[8] 小数点后一位 9 对应 DSPNUM_1in9_off[9] 和 DSPNUM_1in9_off[10] 替换数组\r将这些值替换到数组 DSPNUM_1in9_off 中：\nunsigned char DSPNUM_1in9_off[] = {\r0x00, // [0] 保持为 0x00\r0xfd, // [1] 数字 A 的十位 2 对应\r0x17, // [2] 数字 A 的十位 2 对应\r0xf5, // [3] 数字 A 的个位 3 对应\r0x1f, // [4] 数字 A 的个位 3 对应\r0xf7, // [5] 数字 B 的十位 5 对应\r0x1d, // [6] 数字 B 的十位 5 对应\r0x47, // [7] 数字 B 的个位 4 对应\r0x1f, // [8] 数字 B 的个位 4 对应\r0xf7, // [9] 数字 B 的小数点后一位 9 对应\r0x1f, // [10] 数字 B 的小数点后一位 9 对应\r0xff, // [11] 数字 A 的小数点后一位 8 对应\r0x1f, // [12] 数字 A 的小数点后一位 8 对应\r0x00, // [13] 保持为 0x00\r0x00, // [14] 保持为 0x00\r0x00 // [15] 保持为 0x00\r};\r最终数组\runsigned char DSPNUM_1in9_off[] = {\r0x00, 0xfd, 0x17, 0xf5, 0x1f, 0xf7, 0x1d, 0x47, 0x1f, 0xf7, 0x1f, 0xff, 0x1f, 0x00, 0x00, 0x00\r};\r这个数组 DSPNUM_1in9_off 现在包含了你要求的数字 A 和 B 的十六进制表示形式。\nGPT准确无误的理解了我的意思，这是这段代码直接得到的结果！！：\n动态将数字转换为对应的段码\r上面一段只是实现了数字到段码的转换，作为一个温度计肯定需要每隔一段时间就将读取的温度传到这个数组里，所以我继续问\nGPT又准确无误的给了我方案：\n动态调整数组的代码\r为了动态调整 DSPNUM_1in9_off 数组，你可以编写一个函数，根据给定的 A 和 B 数值，动态设置数组的值。这个函数可以使用一个查找表来将数字映射到相应的字节值。\n以下是一个实现示例：\n#include \u0026lt;stdio.h\u0026gt;\r// 定义数字对应的字节数组\runsigned char digit_bytes[10][2] = {\r{0xbf, 0x1f}, // 0\r{0x00, 0x1f}, // 1\r{0xfd, 0x17}, // 2\r{0xf5, 0x1f}, // 3\r{0x47, 0x1f}, // 4\r{0xf7, 0x1d}, // 5\r{0xff, 0x1d}, // 6\r{0x21, 0x1f}, // 7\r{0xff, 0x1f}, // 8\r{0xf7, 0x1f} // 9\r};\r// 定义DSPNUM_1in9_off数组\runsigned char DSPNUM_1in9_off[16] = {0};\r// 更新数组的函数\rvoid update_display(double A, double B) {\r// 提取 A 和 B 的各位数字\rint A_tens = (int)(A / 10) % 10;\rint A_units = (int)A % 10;\rint A_decimal = (int)(A * 10) % 10;\rint B_tens = (int)(B / 10) % 10;\rint B_units = (int)B % 10;\rint B_decimal = (int)(B * 10) % 10;\r// 设置数字 A\rDSPNUM_1in9_off[1] = digit_bytes[A_tens][0];\rDSPNUM_1in9_off[2] = digit_bytes[A_tens][1];\rDSPNUM_1in9_off[3] = digit_bytes[A_units][0];\rDSPNUM_1in9_off[4] = digit_bytes[A_units][1];\rDSPNUM_1in9_off[11] = digit_bytes[A_decimal][0];\rDSPNUM_1in9_off[12] = digit_bytes[A_decimal][1];\r// 设置数字 B\rDSPNUM_1in9_off[5] = digit_bytes[B_tens][0];\rDSPNUM_1in9_off[6] = digit_bytes[B_tens][1];\rDSPNUM_1in9_off[7] = digit_bytes[B_units][0];\rDSPNUM_1in9_off[8] = digit_bytes[B_units][1];\rDSPNUM_1in9_off[9] = digit_bytes[B_decimal][0];\rDSPNUM_1in9_off[10] = digit_bytes[B_decimal][1];\r}\rint main() {\rdouble A = 23.8;\rdouble B = 54.9;\r// 更新显示\rupdate_display(A, B);\r// 打印数组内容以验证\rfor (int i = 0; i \u0026lt; 16; i++) {\rprintf(\u0026quot;0x%02x \u0026quot;, DSPNUM_1in9_off[i]);\r}\rprintf(\u0026quot;\\n\u0026quot;);\rreturn 0;\r}\r解释\r数字到字节的映射表：\ndigit_bytes 数组包含了每个数字（0 到 9）对应的两个字节的值。 提取数字位：\n使用整数除法和取模运算提取 A 和 B 的十位、个位和小数点后一位。 更新显示数组：\n使用提取到的数字位将 DSPNUM_1in9_off 数组的相应位置更新为查找表中的字节值。 主函数：\n定义 A 和 B 的值，调用 update_display 函数更新显示数组，并打印数组内容以验证。 这样，DSPNUM_1in9_off 数组将根据传入的 A 和 B 值动态更新。\n小数点的处理\r上面已经完整实现了两个数字到数组内的转换，但是转出来没有小数点，根据文档：\n所以要在数组的第4，8，10位做些处理\n我继续对GPT说\nGPT回答：\n为了实现这个功能，我们需要将特定数组位置的十六进制数转换为二进制，修改二进制数中的特定位，然后将其转换回十六进制并存储在数组中。\n以下是修改后的代码，包括处理 DSPNUM_1in9_off[4], DSPNUM_1in9_off[8] 和 DSPNUM_1in9_off[10]：\n#include \u0026lt;stdio.h\u0026gt;\r// 定义数字对应的字节数组\runsigned char digit_bytes[10][2] = {\r{0xbf, 0x1f}, // 0\r{0x00, 0x1f}, // 1\r{0xfd, 0x17}, // 2\r{0xf5, 0x1f}, // 3\r{0x47, 0x1f}, // 4\r{0xf7, 0x1d}, // 5\r{0xff, 0x1d}, // 6\r{0x21, 0x1f}, // 7\r{0xff, 0x1f}, // 8\r{0xf7, 0x1f} // 9\r};\r// 定义DSPNUM_1in9_off数组\runsigned char DSPNUM_1in9_off[16] = {0};\r// 将第六位从右往左数改成1的函数\runsigned char set_sixth_bit_to_one(unsigned char value) {\rreturn value | (1 \u0026lt;\u0026lt; 5); // 第六位对应的二进制位是 5，从0开始计数\r}\r// 更新数组的函数\rvoid update_display(double A, double B) {\r// 提取 A 和 B 的各位数字\rint A_tens = (int)(A / 10) % 10;\rint A_units = (int)A % 10;\rint A_decimal = (int)(A * 10) % 10;\rint B_tens = (int)(B / 10) % 10;\rint B_units = (int)B % 10;\rint B_decimal = (int)(B * 10) % 10;\r// 设置数字 A\rDSPNUM_1in9_off[1] = digit_bytes[A_tens][0];\rDSPNUM_1in9_off[2] = digit_bytes[A_tens][1];\rDSPNUM_1in9_off[3] = digit_bytes[A_units][0];\rDSPNUM_1in9_off[4] = set_sixth_bit_to_one(digit_bytes[A_units][1]); // 修改第六位\rDSPNUM_1in9_off[11] = digit_bytes[A_decimal][0];\rDSPNUM_1in9_off[12] = digit_bytes[A_decimal][1];\r// 设置数字 B\rDSPNUM_1in9_off[5] = digit_bytes[B_tens][0];\rDSPNUM_1in9_off[6] = digit_bytes[B_tens][1];\rDSPNUM_1in9_off[7] = digit_bytes[B_units][0];\rDSPNUM_1in9_off[8] = set_sixth_bit_to_one(digit_bytes[B_units][1]); // 修改第六位\rDSPNUM_1in9_off[9] = digit_bytes[B_decimal][0];\rDSPNUM_1in9_off[10] = set_sixth_bit_to_one(digit_bytes[B_decimal][1]); // 修改第六位\r}\rint main() {\rdouble A = 23.8;\rdouble B = 54.9;\r// 更新显示\rupdate_display(A, B);\r// 打印数组内容以验证\rfor (int i = 0; i \u0026lt; 16; i++) {\rprintf(\u0026quot;0x%02x \u0026quot;, DSPNUM_1in9_off[i]);\r}\rprintf(\u0026quot;\\n\u0026quot;);\rreturn 0;\r}\r解释\r函数 set_sixth_bit_to_one:\n使用位运算将一个字节的第六位（从右数）设置为 1。 更新 DSPNUM_1in9_off 数组:\n按照你的要求更新数字 A 和 B 的各个位数字。 在设置 DSPNUM_1in9_off[4], DSPNUM_1in9_off[8] 和 DSPNUM_1in9_off[10] 时，调用 set_sixth_bit_to_one 函数将其第六位设置为 1。 结果\r运行代码后，DSPNUM_1in9_off 数组将根据 A 和 B 的值动态更新，并且 DSPNUM_1in9_off[4], DSPNUM_1in9_off[8] 和 DSPNUM_1in9_off[10] 的第六位将被设置为 1。\n然后我就得到了：\n这里数字是我手动指定的A=73.6,B=84.9，可以看到小数点，百分号都已经显示出来了\n再接入传感器读到的数值，温度计就差不多完工啦：\n顺便一提这里的传感器驱动代码也是GPT帮调整的，真是神奇\n","date":"2024-07-24T00:00:00Z","permalink":"http://localhost:10354/posts/240724_%E6%AE%B5%E7%A0%81%E5%B1%8F%E5%BC%80%E5%8F%91gpt4o%E5%B8%A6%E6%9D%A5%E7%9A%84%E4%B8%80%E7%82%B9%E7%82%B9%E9%9C%87%E6%92%BC/","title":"段码屏开发—GPT4o带来的一点点震撼"},{"content":"\n一开始玩这个的时候就在想用docker跑，因为实在不想在本机里搭各种乱七八糟的环境，也懒得用Anaconda那样的中间环境，总感觉本地跑个模型才用得上那种大玩意儿，于是在dockerhub上找了找\n一些已有的可用镜像：\nhttps://hub.docker.com/r/aminehy/docker-streamlit-app\nhttps://hub.docker.com/r/samdobson/streamlit\n就是镜像build都好几年前了，实测目前有些新的例程都跑不了，还是自己做个镜像吧\n制作dockerfile\rhttps://docs.streamlit.io/deploy/tutorials/docker\n好在官网已给出方案\n这是我微改后的：\n# app/Dockerfile\rFROM python:3.9-slim\rWORKDIR /app\rRUN apt-get update \u0026amp;\u0026amp; apt-get install -y \\\rbuild-essential \\\rcurl \\\rsoftware-properties-common \\\rgit \\\r\u0026amp;\u0026amp; rm -rf /var/lib/apt/lists/*\rRUN git clone https://github.com/streamlit/streamlit-example.git .\rRUN pip3 install -r requirements.txt\rEXPOSE 8501\rHEALTHCHECK CMD curl --fail http://localhost:8501/_stcore/health\rCMD [\u0026quot;streamlit\u0026quot;, \u0026quot;run\u0026quot;, \u0026quot;main.py\u0026quot;, \u0026quot;--server.port=8501\u0026quot;, \u0026quot;--server.address=0.0.0.0\u0026quot;]\r主要就最后一行并没有用ENTRYPOINT，因为记得这个不是必须，用CMD的好处是非常方便的就能修改docker run时要运行的内容\n构建和使用镜像\r打开CMD，CD到这个Dockerfile保存的目录下\ndocker build -t streamlit_winotmk:latest . 点不要落下\n然后就可用来运行任意py的app文件了\ndocker run -ti --rm -p 8501:8501 -v $(pwd):/app streamlit_winotmk:latest streamlit run name_main_file.py\n$(pwd)换成宿主机的目录，记得暴露8501的默认端口\n我这里目录是C:\\Cloud\\docker\\streamlit\\demo3\\examples\n所以直接:\ndocker run -ti --rm -p 8501:8501 -v C:\\Cloud\\docker\\streamlit\\demo3\\examples:/app streamlit_winotmk:latest streamlit run intro.py\n保持运行并想下次继续用可以\ndocker run -ti -d -p 8501:8501 -v $(pwd):/app --name MystreamlitAPP streamlit_winotmk:latest\n*用容器跑起来的一些例程APP：\n","date":"2024-07-24T00:00:00Z","permalink":"http://localhost:10354/posts/240724_%E7%94%A8%E5%AE%B9%E5%99%A8%E6%9D%A5%E8%BF%90%E8%A1%8Cstreamlit/","title":"用容器来运行streamlit"},{"content":"还是会有很多不常用的命令要来回查，仅记录，绝非完整命令参考\n文件操作相关\r复制目录\r复制目录dir1和dir1目录下的文件到dir2目录里\ncp -r dir1 dir2\r安装lrzsz实现zmodem串口文件传输\nrz 下载Zmodem\rxz 上传Zmodem\rwindterm下支持直接拖拽文件，但是也要安装lrzsz以支持命令\nhttps://www.cnblogs.com/lidabo/p/4780866.html\n挂载U盘\rfdisk -l\r可以看到一块14.84GB的SD卡，位置在/dev/sda1\n使用\nmount -t vfat /dev/sda1 /mnt\r来挂载U盘\ncd到/mnt即可看到U盘里的文件了，另外可以在/mnt里新建文件夹mkdir xxxxx，再挂载到文件夹里\n卸载：\numount /mnt\r打包压缩和解压\r压缩\ntar -czvf ***.tar.gz\r解压\ntar -xzvf ***.tar.gz\rdocker\rhttps://yeasy.gitbook.io/docker_practice/container/run\n启动docker:\nsudo systemctl start docker\r查看已有镜像：\ndocker ps -a\r启动已终止容器:\ndocker container start\r运行新的镜像run：\ndocker run -it -d --name hexo_debian -p 22:22 -p 4000:4000 -v XXX:/hexo/ hexo_debian:V02\rsave:\n把本地镜像打包成tar方便带走\ndocker save -o jre8u342_ch.tar jre8u342_ch:latest\r打包好的tar用的时候可以：\ndocker load -i {image_name}.tar\rdocker load --input {image_name}.tar\r如果没有tag可以手动打tag~\ndocker tag {image_id} {image_name}:{image_tag}\r自用的docker run:\ndocker run -d --name=calibre-web -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -e DOCKER_MODS=linuxserver/mods:universal-calibre -p 8083:8083 -v D:\\calibre_test\\config:/config -v D:\\calibre_test\\library:/books --restart unless-stopped lscr.io/linuxserver/calibre-web:latest\rdocker run -d --name=calibre -e PUID=1000 -e PGID=1000 -e TZ=Asia/Shanghai -e LC_ALL=zh_CN.UTF-8 -p 8080:8080 -p 8181:8181 -p 8081:8081 -v D:\\calibre_test\\library:/library -v D:\\calibre_test\\config:/config --restart unless-stopped lscr.io/linuxserver/calibre:latest\rdocker compose\r启动组\ndocker compose -f hexo_debian_DockerCompose.yml up -d 关闭组\ndocker compose -f hexo_debian_DockerCompose.yml down -v\n启动但是会留在容器里\ndocker compose up\n启动不留在容器里\ndocker compose up -d\n进入docker容器\ndocker exec -it XXX /bin/bash\r退出容器但保留按ctrl+P+Q\n也可以直接接要在容器里执行的命令\ndocker exec hexo hexo g -d\r拷贝容器内的文件出来，在宿主机上输入：\ndocker cp -a vsftpd:/etc/services /root/\rscreen\r# 创建一个新的窗口\rscreen -S test\r# 进入窗口后 执行文件\rpython test.py\r# 退出当前窗口\rctrl+a+d （方法1：保留当前窗口）\rscreen -d （方法2：保留当前窗口）\rexit （方法3：退出程序，并关闭窗口）\r# 查看窗口\rscreen -ls\r# 重新连接窗口\rscreen -r id或窗口名称\r","date":"2024-06-19T00:00:00Z","permalink":"http://localhost:10354/posts/240619_linux%E5%91%BD%E4%BB%A4/","title":"Linux和docker常用命令"},{"content":"\n收集一些看到的好玩的可能以后会用到的软件/服务，软件类大多可以docker部署\n不定期更新\n24.8.6更新\nA.网站推荐\r开源大世界\r开源大世界 专注于应用级的开源软件、开源资料的情报收集汇总整理。\nhttps://kydsj.vip/doku.php?id=wiki:网站目录#计算机辅助设计+\nhttps://kydsj.vip/doku.php?id=wiki:自托管-电子书和综合图书馆系统\n很多开源软件项目分享，分类详细品种丰富\nlinuxserver.io\rLinuxServer.io 文档之家！我们的目标是确保所有镜像都正确记录所有相关信息，以帮助我们的用户入门。除了每个镜像的单独设置指南外，还有与运行 Docker 容器有关的一般信息和最佳实践\nhttps://docs.linuxserver.io/images/docker-calibre-web/\nwebpagetest.org\rwww.webpagetest.org\n感觉是很强的网站性能分析工具\n又拍云\rhttps://www.upyun.com/\nautodl\rhttps://www.autodl.com/market/list\nB.影音/文件/资料整理\remby\r任何设备上的个人媒体\n将您家里的所有视频、音乐和照片集中到一处从未如此简单。您的个人 Emby 服务器会自动即时转换和流式传输您的媒体，以便在任何设备上播放\nhttps://github.com/MediaBrowser/Emby?tab=readme-ov-file\nhttps://emby.media/\njellyfin\rjellyfin是一套多媒体应用程序软件套装，旨在组织、管理和共享数字媒体文件\nhttps://github.com/jellyfin/jellyfin\nhttps://jellyfin.org/\ncalibre\rCalibre-Web 是一款网络应用程序，它使用有效的Calibre数据库提供简洁直观的界面来浏览、阅读和下载电子书\nhttps://github.com/janeczku/calibre-web\nhttps://calibre-ebook.com/\n目前自用的docker镜像：\nhttps://hub.docker.com/r/johngong/calibre-web\nNextcloud\rNextcloud是一套用于建立网络硬盘的客户端－服务器软件。其功能与Dropbox相近，但Nextcloud是自由及开放源代码软件，每个人都可以在私人服务器上安装并执行它。\n与Dropbox等专有服务相比，Nextcloud的开放架构让用户可以利用应用程序的方式在服务器上新增额外的功能，并让用户可以完全掌控自己的资料。\nhttps://github.com/nextcloud\nhttps://nextcloud.com/\nFound\r高效设计师必备的文件浏览器 Found，一键预览三维模型、序列帧、HDR\nhttps://www.aalab.com.cn/\nC.工具类\rmatomo\rMatomo 是领先的免费/自由开放分析平台。\nMatomo 是一款功能齐全的 PHP MySQL 软件程序，您可以下载并安装在自己的网络服务器上。在五分钟的安装过程结束时，您将获得一个 JavaScript 代码。只需将此标签复制并粘贴到您希望跟踪的网站上，即可实时访问您的分析报告。\nMatomo 旨在成为 Google Analytics 的免费软件替代品，目前已在 1,400,000 多个网站上使用。隐私功能已内置\nhttps://github.com/matomo-org/matomo\nhttps://matomo.org/\nUpverter\rUpverter 是一个模块化的、基于网络的电子电路设计工具，可以完成所有工作——PCB 设计、原理图、自动布线、3D 预览和按照您的确切规格构建订单——用户不再需要为开源项目付费。\nhttps://upverter.com/\nmanim\rhttps://www.manim.community/\n可以做出3B1B那样好看的数学动画（可以用来做视频的工具)\n","date":"2024-06-19T00:00:00Z","permalink":"http://localhost:10354/posts/240619_%E8%BD%AF%E4%BB%B6%E6%94%B6%E9%9B%86/","title":"软件和网站收集"},{"content":"简介\r想要做一个便携的小设备，能够实现以下功能\n记录当前地点的气压，温度，湿度等地理信息 记录GPS坐标信息 考虑加上摄像头记录当前周围视觉环境，同时可以将上述信息水印（字幕)在照片上 存储所有记录的数据以便之后进行可视化数据生成，可以用类似XML，Json，或者找有没有嵌入式轻量数据库实现 它最好有以下这样的特点：\n手机一般大小可以塞进口袋 一定程度的防摔防水外壳 续航可以接受2-3天一充电 所以我的打算用现有的能买到的小板子和单片机来做，预算不是大问题，大概1500-2000，（包含试错和学习成本）考虑过几种方向：\nESP32 树莓派PICO 幸狐的板子和摄像头 树莓派Zero\n最后发现现在目前树莓派zero2w的价格只有一百出头了，可能比某些arduino的原版板子还便宜，值得一试，幸狐看起来也不错的样子，回头再研究 下面这是树莓派zero2w跑通串口通信时的样子\n这个网站不错：https://pinout.xyz/\n可知右上这几个接口就可以实现TTL的UART连接了，我尝试ground是要接的\n资料\rFT232串口工具\rhttps://www.waveshare.net/wiki/FT232_USB_UART_Board\nGPS模块\rhttps://www.waveshare.net/wiki/LC76G_GPS_Module\n在准备安装micropyGPS时\n提示No module namd setuptools\n怀疑需要执行\napt-get install python3-setuptools\n可惜目前没有网络环境，回家尝试了\nRaspberry Zero 2W\rhttps://www.waveshare.net/wiki/Raspberry_Pi_Zero_2_W\nUPS 模块\rhttps://www.waveshare.net/wiki/UPS_HAT_(C)\n环境传感器\rhttps://www.waveshare.net/shop/Environment-Sensor-HAT.htm\n项目/软件\r数据可视化相关\r很不错的开源教程Data-Science-For-Beginners\rhttps://microsoft.github.io/Data-Science-For-Beginners/#/\nMatplotlib\rhttps://matplotlib.org/stable/index.html\nMatplotlib是一个出色的库，可用于创建各种简单和复杂的图表\nhttps://microsoft.github.io/Data-Science-For-Beginners/#/3-Data-Visualization/09-visualization-quantities/README\nStreamlit\rhttps://github.com/streamlit/streamlit\n更偏向于python库直接生成web，同时也有很多数据可视化的内容，更实用？便于展示\npowerbi\rhttps://www.microsoft.com/en-us/power-platform/products/power-bi\n似乎是微软的web数据可视化绘图\nGPXSee\r配合gps数据收集可以展示出来\nhttps://github.com/tumic0/GPXSee\n图形库\rLVGL\rhttps://lvgl.100ask.net/master/get-started/index.html\nhttps://github.com/lvgl/lvgl\nSquareLine Studio UI - 配合上面的LVGL用\rhttps://squareline.io/\nhttps://www.bilibili.com/video/BV1DX4y1v727/?vd_source=b7b7bdf106a064893c3c79e4a961f383\nguiguider 同上类别但免费\rhttps://www.bilibili.com/video/BV1yW421R7zK/?spm_id_from=333.788.recommend_more_video.7\u0026vd_source=b7b7bdf106a064893c3c79e4a961f383\nfigma\rUI前期设计软件\nUI 框架：oled-ui-astra\rhttps://github.com/AstraThreshold/oled-ui-astra\nhttps://www.bilibili.com/video/BV1i4421D7nJ/?vd_source=b7b7bdf106a064893c3c79e4a961f383\n","date":"2024-06-17T00:00:00Z","permalink":"http://localhost:10354/posts/240617_%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E5%99%A8%E8%AE%A1%E5%88%92/","title":"地理数据采集器计划"},{"content":"这么个小小的软件花费了不成正比的时间去弄他，十分令人头疼，简单记录几点重要的设置\nvim /etc/vsftpd.conf\rvsftpd 配置文件：\nhttps://gnu-linux.readthedocs.io/zh/latest/Chapter02/90_vsftpd.html\n修改ftp的端口\rftp的监听和实际数据传输是两个端口，如果要改最好都改\nconnect_from_port_20=NO\rftp_data_port=12520\rlisten_port=12521\rpasv模式时的端口范围设置，假如用docker运行这些端口都要转出来\npasv_promiscuous=YES\rpasv_min_port=31100\rpasv_max_port=31110\r我至今没太搞明白ftp的主动与被动模式的区别，以及能不能只用其中一种模式来工作..\n另外还有系统的services里\nvim /etc/services\r#ftp-data 20/tcp\r#ftp-data 20/udp\rftp-data 12520/tcp\rftp-data 12520/udp\r这个不确定是否必要但还是改了吧\n中文乱码\r一篇不错的配置说明\nhttps://blog.starryvoid.com/archives/1044.html\n主要提到了utf8的编码问题\nutf8_filesystem=YES\n如果这样还没解决，考虑是要修改容器本身的LANG\n可以直接进入容器然后类似：\nexport LANG=C.UTF-8\n或者\nexport LANG=en_US.UTF-8\n输入locale查看结果\n当然这样关了这个sh就没了，所以可以直接加到docker启动时的环境变量里\nhttps://zihengcat.github.io/2018/09/10/change-locale-system-encoding-in-docker-container/\n然后你猜怎么着，做完这些设置以后中文依然显示为乱码，但是在FileZilla里看却没问题\n现在高度怀疑是VScode的这个SFTP同步插件的锅\n","date":"2024-06-17T00:00:00Z","permalink":"http://localhost:10354/posts/240617_%E4%BB%A4%E4%BA%BA%E5%A4%B4%E7%96%BC%E7%9A%84vsftpd/","title":"令人头疼的vsftpd,ftp端口修改设置配置"},{"content":"创建阿里云PAI DSW实例跑kohya\r镜像我这里选：\ndsw-registry-vpc.cn-shanghai.cr.aliyuncs.com/pai/modelscope:1.10.0-pytorch2.1.0tensorflow2.14.0-gpu-py310-cu118-ubuntu22.04\n我这里用默认的镜像，实测截至2024.01.10时，直接拉kohya的github可以直接用，不需要改动cuda之类的操作\n安装kohya_ss\rkohya_ss仓库地址：\nhttps://github.com/bmaltais/kohya_ss\nkohya_ss是个webui训练器，SD web_ui里也有对应的Dreambooth训练插件移植，如果只拿来训练不需要跑完整的sd webui服务，只需要kohya就可以了,kohay也可以练lora\n在workspace根目录直接：\ngit clone https://github.com/bmaltais/kohya_ss.git\r很快就能完成，接着依次执行\ncd ./kohya_ss\rapt update -y \u0026amp;\u0026amp; apt install -y python3-tk\rchmod +x ./setup.sh\r./setup.sh\r虽然镜像里带py310，但是似乎还是要装一下python3-tk\n之后安装脚本会自动完成，我大概花了5分钟\n然后运行启动webui\nHF_ENDPOINT=https://hf-mirror.com ./gui.sh --headless\r点击这个本地的IP即能点开webui了\nHF_ENDPOINT=https://hf-mirror.com是为了防止抱脸会更新卡住而用的镜像网站（我确实因为这个卡过）或者见本站另一篇专门说代理的文章：\nhttps://winotmk.github.io/240109_Linux%E4%B8%8A%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BB%A3%E7%90%86%E5%B7%A5%E5%85%B7/\nkohya_ss的Dreambooth训练参数\rsource model\r我这里用自己上传的模型，可以先上传至阿里云oss再挂载进来，所以这里这样选，然后填模型路径就好了\nfloders\r这个tag里比较简单，没什么好说的\nImage folder里写上训练集目录，注意写上的目录底下应该是例如10_ABC目录，然后再放图和txt文件，这个10就step的10，和lora训练时候一样\nparameters\rbasic\r和lora训练设置大同小异，但是参数要比lora小得多，因为Dreambooth比lora性能消耗要大得多而且非常容易过拟合，图出来一滩浆糊，比如我尝试epoch可能10以内就足够，由于文件比较大Save every N epochs我一般也就3-4，其他参数看个人需求吧\nsamples\r这里能填关键词和每多少轮出个预览图，玩玩用\n都准备好了就可以点 start training，但webui不会有任何提示..要看之前启webui的终端\n这样就是开始训练了：\n不过我第一次成功启动了webui但是点开始训练以后，报过类似这样的错：\nThe following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/nvidia/lib64'), PosixPath('/usr/local/nvidia/lib')}\r/usr/local/lib/python3.10/dist-packages/bitsandbytes/cuda_setup/main.py:166: UserWarning: /usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/cuda-11 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...\rwarn(msg)\rThe following directories listed in your path were found to be non-existent: {PosixPath('//license-pai.cn-shanghai.data.aliyun.com'), PosixPath('http')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('dsw-registry-vpc.cn-shanghai.cr.aliyuncs.com/cloud-dsw/eas-service'), PosixPath('aigc-torch113-cu117-ubuntu22.04-v0.2.1')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('http'), PosixPath('8088/dsw-301739'), PosixPath('//127.0.0.1')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('Asia/Shanghai')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('tcp'), PosixPath('443'), PosixPath('//10.192.0.1')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('https'), PosixPath('//dsw-cn-shanghai.data.aliyun.com')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('tcp'), PosixPath('443'), PosixPath('//10.192.0.1')}\rThe following directories listed in your path were found to be non-existent: {PosixPath('/home/pai/bin/python')}\rCUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...\rDEBUG: Possible options found for libcudart.so: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}\rCUDA SETUP: PyTorch settings found: CUDA_VERSION=118, Highest Compute Capability: 7.0.\rCUDA SETUP: To manually override the PyTorch CUDA version please see:https://github.com/TimDettmers/bitsandbytes/blob/main/how_to_use_nonpytorch_cuda.md\r/usr/local/lib/python3.10/dist-packages/bitsandbytes/cuda_setup/main.py:166: UserWarning: WARNING: Compute capability \u0026lt; 7.5 detected! Only slow 8-bit matmul is supported for your GPU! If you run into issues with 8-bit matmul, you can try 4-bit quantization: https://huggingface.co/blog/4bit-transformers-bitsandbytes\rwarn(msg)\rCUDA SETUP: Loading binary /usr/local/lib/python3.10/dist-packages/bitsandbytes/libbitsandbytes_cuda118_nocublaslt.so...\rlibcusparse.so.11: cannot open shared object file: No such file or directory\rCUDA SETUP: Something unexpected happened. Please compile from source:\rgit clone https://github.com/TimDettmers/bitsandbytes.git\rcd bitsandbytes\rCUDA_VERSION=118 make cuda11x_nomatmul\rpython setup.py install\rTraceback (most recent call last):\rFile \u0026quot;/usr/lib/python3.10/runpy.py\u0026quot;, line 187, in _run_module_as_main\rmod_name, mod_spec, code = _get_module_details(mod_name, _Error)\rFile \u0026quot;/usr/lib/python3.10/runpy.py\u0026quot;, line 146, in _get_module_details\rreturn _get_module_details(pkg_main_name, error)\rFile \u0026quot;/usr/lib/python3.10/runpy.py\u0026quot;, line 110, in _get_module_details\r__import__(pkg_name)\rFile \u0026quot;/usr/local/lib/python3.10/dist-packages/bitsandbytes/__init__.py\u0026quot;, line 6, in \u0026lt;module\u0026gt;\rfrom . import cuda_setup, utils, research\rFile \u0026quot;/usr/local/lib/python3.10/dist-packages/bitsandbytes/research/__init__.py\u0026quot;, line 1, in \u0026lt;module\u0026gt;\rfrom . import nn\rFile \u0026quot;/usr/local/lib/python3.10/dist-packages/bitsandbytes/research/nn/__init__.py\u0026quot;, line 1, in \u0026lt;module\u0026gt;\rfrom .modules import LinearFP8Mixed, LinearFP8Global\rFile \u0026quot;/usr/local/lib/python3.10/dist-packages/bitsandbytes/research/nn/modules.py\u0026quot;, line 8, in \u0026lt;module\u0026gt;\rfrom bitsandbytes.optim import GlobalOptimManager\rFile \u0026quot;/usr/local/lib/python3.10/dist-packages/bitsandbytes/optim/__init__.py\u0026quot;, line 6, in \u0026lt;module\u0026gt;\rfrom bitsandbytes.cextension import COMPILED_WITH_CUDA\rFile \u0026quot;/usr/local/lib/python3.10/dist-packages/bitsandbytes/cextension.py\u0026quot;, line 20, in \u0026lt;module\u0026gt;\rraise RuntimeError('''\r以及如果遇到类似：\nCould not load dynamic library 'libcudart.so.11.0'\r重新装适合的CUDA版本即可解决，如果要装CUDA：\nCUDA相关\r安装CUDA指定版本\r遇到过cuda版本不匹配的问题，记一下配置过程\ncuda下载：https://developer.nvidia.com/cuda-downloads\n但是有时候需要特定版本：https://developer.nvidia.com/cuda-toolkit-archive\n以11.8为例，系统是ubuntu22.04，所以这样选：\n下载安装cuda：\ncd /mnt/workspace\rwget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run\rsudo sh cuda_11.8.0_520.61.05_linux.run\r大约3-4GB左右，运行后需要等一会，会弹出交互界面\n这里去掉安装驱动，因为我们已经有驱动了只是想要不同版本的cuda，然后选安装\nps如果遇到装了多份驱动需要卸一个的情况：\nhttps://www.jianshu.com/p/54928967e417\n装好以后他会提示：\n需要往 LD_LIBRARY_PATH 和 PATH 里添加两条环境变量\nexport LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-11.8/lib64\rexport PATH=$PATH:/usr/local/cuda-11.8/bin\r之后我使用\npython -m bitsandbytes\r如果没有报错应该就是好用的\nps如果是windows上的wsl：\nexport LD_LIBRARY_PATH=/usr/lib/wsl/lib/\r切换cuda版本\rexport LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-11.7\rexport BNB_CUDA_VERSION=117\r改环境变量可以手动切换版本（当然得已经装了)\n查看cuda版本\rnvidia-smi\r或者可以：\n参考：https://blog.csdn.net/Kefenggewu_/article/details/117675079\n默认cuda会装在/usr/local,所以查看安装版本可以这样：\nls -l /usr/local | grep cuda\r或者据说可以nvcc -V # (V大写)\n本节另外的参考：https://github.com/TimDettmers/bitsandbytes/blob/main/how_to_use_nonpytorch_cuda.md\n链接\rkohya_ss:\nhttps://github.com/bmaltais/kohya_ss\n一个封装好的kohya-docker的镜像\nhttps://github.com/ashleykleynhans/kohya-docker\ndreambooth相关介绍：\nhttps://huggingface.co/docs/diffusers/training/dreambooth\nhttps://github.com/google/dreambooth\n","date":"2024-01-11T00:00:00Z","permalink":"http://localhost:10354/posts/240110_sd%E5%A4%A7%E6%A8%A1%E5%9E%8B%E4%BA%91%E4%B8%8A%E8%AE%AD%E7%BB%83/","title":"StableDiffusion大模型(Dreambooth)云上训练以及安装CODA指定版本"},{"content":"\n阿里云的AI白票试用还是很香的，b站顺便一搜有很多教程，跑个lora训练或者SD webui之类的\n但难免会遇到要拉更新之类的情况，github和huggingface.co速度慢或者连不上去也经常遇到，除了使用镜像站以外，还有可以使用代理来加速\n先通SOCKS5！\r安装ss\r先贴上需要用到的软件github：\nhttps://github.com/shadowsocks/shadowsocks-libev\n以及大概解释了什么是ss2，ss-go，ss-libev\nhttps://shadowsocks5.github.io/en/spec/Implementations.html\n在云端实例命令行下，需要个尽可能简洁小巧又好用的工具，ss-libev可能会是我们的首选，ss-libev是一个轻量级安全 SOCKS5 代理，适用于嵌入式设备和低端设备，用纯 C 编写，体积小巧比较高效\n我的云计算镜像是基于ubuntu22.04的\n要安装它，直接\nsudo apt update\rsudo apt install shadowsocks-libev\r配置ss\r然后编辑设置：\n# Edit the configuration file\rsudo vim /etc/shadowsocks-libev/config.json\r在config.json里\n{\r\u0026quot;server\u0026quot;:\u0026quot;my_server_ip\u0026quot;,\r\u0026quot;mode\u0026quot;:\u0026quot;tcp_and_udp\u0026quot;,\r\u0026quot;server_port\u0026quot;:8388,\r\u0026quot;local_port\u0026quot;:1080,\r\u0026quot;password\u0026quot;:\u0026quot;barfoo!\u0026quot;,\r\u0026quot;timeout\u0026quot;:600,\r\u0026quot;method\u0026quot;:\u0026quot;chacha20-ietf-poly1305\u0026quot;\r}\rserver :您的主机名或服务器 IP (IPv4/IPv6) mode :模式一般不动 server_port :服务器端口号 local_port :本地端口号，一般默认就1080 password :密码 timeout :连接超时（以秒为单位） method :加密算法 这些信息只要你找的代理供应商支持ss协议应该都可以拿到\nps顺便给同学们复习下vim，懒得用vim的可以不看，按a进入编辑模式，方向键移动光标，编辑完成后按两下 ctrl+c 进入指令模式然后:wq!保存更改并退出,如果直接退出不保存是:q!\n启动ss客户端\r任意目录输入\nss-local\r即可做为客户端启动\n这里我启动成功以后显示：\nps这个软件可以以服务端启动，同样也是修改上面的etc/shadowsocks-libev/config.json,这里挺容易混淆啊，我这里的目标是想给我的云上GPU计算实例代理加速，所以以客户端启动就行\n如果要以服务端启动\nsystemctl start shadowsocks-libev.service\rsystemctl如果云上镜像里没有（大概率没有，容器镜像谁会带systemctl或者systemd呢~），可以尝试\nsudo /etc/init.d/shadowsocks-libev start\r安装proxychains使软件走代理\r上面只做到了客户端使用SOCKS5打通代理，接下来再用另外一个软件使我们指定的命令/app走这条SOCKS5线路，也就是需要个SOCKS5转HTTP的工具来为我们所用\n这里发现了proxychains\nProxyChains 是一个强制应用的 TCP 连接通过代理的工具，支持 Tor、HTTP、与 Socks 代理。ProxyChains 只会将当前应用的 TCP 连接转发至代理，而非全局代理。\n安装proxychains\rsudo apt install proxychains\r超快就安装好了\n配置\rvim /etc/proxychains.conf\r[ProxyList]\r# add proxy here ...\r# meanwile\r# defaults set to \u0026quot;tor\u0026quot;\r#socks4 127.0.0.1 9050\r# example\rsocks5 127.0.0.1 1080\r使用\rProxyChains 的使用方式非常简单，直接在应用程序前加上 proxychains 即可\n例如：\nproxychains git clone https://github.com/rofl0r/proxychains-ng\r但是据说ping是不行的，因为pin并不是TCP而是ICMP，所以可以尝试proxychains ping google.com,总之我是能解析出IP但是会卡住ping不了，问题不大\n试试看是不是通了：\n先试试\ncurl cip.cc\r得到\n我们加上proxychains以后\nproxychains curl cip.cc\r看！效果立竿见影，而且可以灵活使用\n另外一种方法或许可以不装proxychains\n直接设置变量\nexport http_proxy=\u0026quot;socks5://127.0.0.1:1080\u0026quot;\rexport https_proxy=\u0026quot;socks5://127.0.0.1:1080\u0026quot;\r可能也可以但没试过\n其他一些镜像方案：\rhuggingface\r运行python时前加HF_ENDPOINT=https://hf-mirror.com，这样就可以实现后续走镜像加速了\nHF_ENDPOINT=https://hf-mirror.com python your_script.py\r详细用法：\nhttps://hf-mirror.com/\ngithub\r示例用法，直接github域名前加https://mirror.ghproxy.com/\nhttps://mirror.ghproxy.com/https://github.com/d8ahazard/sd_dreambooth_extension\r详细见：\nhttps://mirror.ghproxy.com/\n有些部署文件里还是用的之前的域名https://ghproxy.com/,已失效，改用二级域名https://mirror.ghproxy.com/即可\n附录\r本文参考文章\rlinux命令行代理神器-proxychains\nhttps://zhuanlan.zhihu.com/p/166375631\nLinux 让终端走代理的几种方法\nhttps://zhuanlan.zhihu.com/p/46973701\nss服务端和客户端安装\nhttps://mkmerich.com/2018-09-23/shadowsocks%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E8%A3%85.html\n基本概念,什么是ss什么是socks5\nhttps://reezon.github.io/2018/05/23/%E5%85%B3%E4%BA%8Ess(%E9%85%B8%E9%85%B8)%E5%92%8Cssr(%E9%85%B8%E9%85%B8%E4%B9%B3)%EF%BC%8C%E8%BF%98%E6%9C%89vpn%E5%92%8Csocks5/\n使用Curl时可以直接用socks5\nhttps://blog.emacsos.com/use-socks5-proxy-in-curl.html\n其他类似方案软件\rsshuttle\nhttps://github.com/sshuttle/sshuttle\nyuhaiin\nhttps://github.com/yuhaiin/yuhaiin\nclash-verge\nhttps://github.com/zzzgydi/clash-verge\n","date":"2024-01-09T00:00:00Z","permalink":"http://localhost:10354/posts/240109_linux%E4%B8%8A%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BB%A3%E7%90%86%E5%B7%A5%E5%85%B7/","title":"Linux上的命令行代理工具"},{"content":"\n事先：我是用路由拨号所以家里已经有外网直连IP，且配置了DDNS和端口转发，所以一个域名即可连上NAS\n另外我的群晖是DS720+，是块X86intel的CPU，所以和PC一样用X86的容器镜像就可以，如果是ARM机NAS应该是不通用的\n所用镜像：https://hub.docker.com/r/garethflowers/svn-server\n备选镜像（看起来也很不错，拉取次数也过1M：https://hub.docker.com/r/elleflorio/svn-server\nSVN网站：https://subversion.apache.org/\n参考：\nhttps://blog.51cto.com/u_12701820/6544028\n准备镜像\r由于在群晖的ContainerManager里直接添加镜像不能，应该是要配个docker的镜像站加速或者整个NAS在梯子环境里，懒得整了，我这次选择PC上保存镜像包再拖来NAS里用的形式，个人感觉更方便些\n先在PC上拉个镜像，直接\ndocker pull garethflowers/svn-server:latest\r然后把镜像打包成文件\ndocker save -o svn-server.tar garethflowers/svn-server:latest\r就能得到一个svn-server.tar的文件了，把这个文件上传到ContainerManager里\n然后左边的TAG里选容器》新增，选择刚上传的svn-server\n配置镜像\r镜像用法说明，基本上配置个端口和映射库就行\n/SVN_library/SVN_Folder是我专门创建的新的NAS文件夹\n之后下一步容器就能启动起来了\n打开终端机》通过命令启动》用/bin/sh 来开一个交互的shell\n然后我输入\nsvnadmin create WinSVN\r来建我的第一个SVN仓库名为WinSVN\n（以下部分参考: https://cloud.tencent.com/developer/article/1650131\n然后找到/SVN_library/SVN_Folder/WinSVN/conf，里面是SVN的配置文件了\n编辑svnserve.conf\nanon-access = none #取消匿名访问\nauth-access = write #授权用户有可写权限\npassword-db = passwd #指定用户配置文件，后面会用到\n编辑passwd\n添加了自己的账户，至于分区权限我暂时用不到\n记得重启容器，服务器部分好像就差不多了\n最后别忘记路由器上配个3690端口转发来远程访问这个仓库，我用的是ikuai的路由OS\n测试连接\rpc端新建个文件夹，右键SVN CheckOut\n地址可以输入svn://DDNS的域名:3690/WinSVN，输入上面passwd文件里设置好的用户名和密码就好了！！\n之后就是svn客户端的基本用法了，随便放一个文件尝试上传\n很快就传好了，至此这个SVN仓库宣告可用！\n","date":"2023-12-14T00:00:00Z","image":"http://pictures.winotmk.com/%E7%BE%A4%E6%99%96%E4%B8%8A%E6%90%AD%E5%BB%BASVN%E6%9C%8D%E5%8A%A1%E5%99%A8/2025-02-28-00-24-37_b1d8f5bc.png","permalink":"http://localhost:10354/posts/%E7%BE%A4%E6%99%96%E4%B8%8A%E6%90%AD%E5%BB%BAsvn%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"群晖上用容器搭建SVN服务器"},{"content":"计费文档：\nhttps://help.aliyun.com/document_detail/447697.html\n定价标准：\nvCPU单价（vCPU）：0.000049 元/秒\n内存单价（GiB）： 0.00000613 元/秒\n所以可知：\n规格 秒 分钟 小时 天 月 年 每1u 0.00004900 0.00294 0.1764 4.2336 127.008 1545.264 每1G内存 0.00000613 0.0003678 0.022068 0.529632 15.88896 193.31568 eci价格计算：\n实例规格 秒 分钟 小时 天 月 年 0.25u\t0.5G 0.00001532 0.0009189 0.055134 1.323216 39.69648 482.97384 0.5u\t1G 0.00003063 0.0018378 0.110268 2.646432 79.39296 965.94768 2u\t4G 0.00012252 0.0073512 0.441072 10.585728 317.57184 3863.79072 2u\t8G 0.00014704 0.0088224 0.529344 12.704256 381.12768 4637.05344 4u\t8G 0.00024504 0.0147024 0.882144 21.171456 635.14368 7727.58144 64u\t256G 0.00470528 0.2823168 16.939008 406.536192 12196.08576 148385.7101 一秒0.0047元很便宜吗？一月要1.2w！可以说被安排得明明白白了\n","date":"2023-08-25T00:00:00Z","permalink":"http://localhost:10354/posts/docker01.1_%E4%BB%B7%E6%A0%BC%E8%AE%A1%E7%AE%97%E8%A1%A8/","title":"Docker01.1_eci价格计算表"},{"content":" 一口气步子迈得有大，慢慢记录一下,如果你碰巧看到这个文章，希望这个文章的某些部分对你有帮助，来源我已尽量在文章中标出，还有很多部分是自己敲的\n了解ECI弹性容器：https://www.aliyun.com/product/eci\n了解阿里云NAS文件存储：https://www.aliyun.com/product/nas\n为什么要用eci来运行hexo？\n因为好玩，同时来学习从pull到发布到运行整个docker镜像的流程，也想给自己的hexo博客找个新家，酷酷的那种\n本博客之前是由树莓派上的hexo生成，部署到github上的\n最近在捣鼓docker，一时想不起来有什么灵活小巧的服务拿来用docker玩，那么想着干脆把树莓派上hexo这部分服务做成镜像，需要用的时候拿出来用用想必是极好的（这么一来好像树莓派又要吃灰了）\n恰巧最近又在琢磨阿里云ECI容器服务，所以理论上是可以用我自己打包好的镜像的\n最后成品的结构大致如下图：\n这里挂了3个镜像：\n1.node.js+git+ssh+hexo\n主要是此镜像——由node.js+hexo组成的运行hexo环境，用过的都了解hexo是基于node.js的，每次我们生成文章的时候都会hexo g -d，而运行这套需要一个环境容器\ngit和ssh主要是部署在github上用的，同时我习惯用VSCode的SSH FS来管理远程文件和写博客，主要是ssh连接，也方便我拿PuTTY和WinSCP远程登录管理\n2.vsftpd\n一个常用的ftp服务，我是在本地些完再上传的，用这个是因为我发现如果要给文章插入图片，我还需要手动用ssh上传到hexo对应目录里。而用VSCode的SSH FS可以帮我自动同步本地工作目录和云上即将生成静态网页的hexo目录，非常方便！\n3.ddns\n因为容器是即用即开，用完就释放的，每次开会新分配一个弹性IP做为外网接口，但是不想每次都去复制这个新的ip地址，那么就要用到动态域名解析，刚好我在阿里云上购买过一个我自己的域名，所以ddns这部分服务就拉出来做个镜像\n还挂了一个NAS盘：\n挂载以后：\n可见我的hexo，主题，文章，图片等等都存放在里面，服务容器可以随便释放拉取，数据不会受到影响，几百M的NAS容量价格抹零后可以忽略不计\n文章后面（第三部分）会说如何按我的需求构建定制这几个镜像，并上传到阿里云容器镜像ARK仓库以方便调用\nvsftpd还有ddns可以与主镜像node.js+hexo合并成一个大镜像吗？\n当然可以，但我实际做了几次以后发现把ftp，ddns这样常用的服务功能单独拿出来会方便得多的多，毕竟我想起别得服务，也可以给他们挂上ftp等常用服务，我也可以选择不挂，这样容器的优势就体现出来了。我可以把单一的服务都做成单独的小镜像，需要哪个挂哪个，性能消耗也很小\n整套下来有这些部分：\ndocker基本操作 已经启动的本地容器修改端口，启动容器时即启动服务等 打包制作自己的docker镜像(dockerfile) docker镜像打包并上传到阿里云镜像库ARK eci容器创建模板和eci命令行工具使用 hexo本地编辑环境设置————如何用VSCode舒服的写MD文档 附表：\n群晖搭建私有镜像仓库和dockerengine设置\neci价格计算表\n1. docker 基本操作\r博主吐槽一下，总觉得一些类似run，commit操作完全可以做成一个美观好用的UI控制软件，但是docker destop就是不做，然后大家都默认敲命令行是方便的，好用的。十分不解，可能需要ui的不会写ui，熟练使用命令行的也不需要什么ui吧，诶\n——后面随着对docker了解的深入，明白它不是虚拟机，用得还是linux内核，这么一想，处处真是浓浓的linux味，现在能提供一个windows下的Docker Desktop桌面程序，已经非常得不错了！\n资料网站：\n官方命令大全\n基于Docker的Hexo博客搭建\n这个基本操作写得还行下次爬一篇下来吧：\n[小抄] Docker 基本命令\n1.1 运行容器\rdocker run -it -d --name [container-name] -p 8088:80 [image-name] 这里是将容器内的80端口映射到宿主机的8088端口\n参数说明\n-d 表示后台运行容器\n-t 为docker分配一个伪终端并绑定到容器的标准输入上\n-i 是让容器的标准输入保持打开状态\n-p 指定映射端口\n还能这么写：\ndocker run --name mssql -e 'ACCEPT_EULA=Y' -e 'SA_PASSWORD=xxxx' \\ -p 1433:1433 \\ -d mssql-2019-with-cimb \\应该是可以换行表述\n-e 定义环境变量（通常制作镜像的时候应该已经写好了，或者在容器内做好自动脚本，run时候再写毕竟是不方便的）\n1.2 将此容器 commit 保存为新镜像：\r格式：\ndocker commit container-id new-name container-id也可以是已有容器的名字，例如：\ndocker commit node-test nodehexo nodehexo这里是新镜像名\n1.3 启动docker引擎时自动运行docker容器：\rhttps://blog.csdn.net/londa/article/details/97611947\nps:上面链接文章还有:修改docker容器的挂载路径，修改docker默认的存储位置\ndocker run --restart=always 有时候，我们创建容器时忘了添加参数 --restart=always ，当 Docker 重启时，容器未能自动启动，\n现在要添加该参数怎么办呢，方法有二：\n1、Docker 命令修改\ndocker container update --restart=always 容器名字 我实际运行时，可以支持同时配置多个容器id，比如（其中container关键字可以忽略不写）\ndocker update 87cd61ad7f7c f488b0479f24 2109903220ce 1fb346ea1a46 --restart=no 2、直接改配置文件\n首先停止容器，不然无法修改配置文件\n配置文件路径为：/var/lib/docker/containers/ 容器ID\n在该目录下找到一个文件 hostconfig.json ，找到该文件中关键字 RestartPolicy\n修改前配置：\u0026quot;RestartPolicy\u0026quot;:{\u0026quot;Name\u0026quot;:\u0026quot;no\u0026quot;,\u0026quot;MaximumRetryCount\u0026quot;:0}\n修改后配置：\u0026quot;RestartPolicy\u0026quot;:{\u0026quot;Name\u0026quot;:\u0026quot;always\u0026quot;,\u0026quot;MaximumRetryCount\u0026quot;:0}\n最后启动容器。\n1.4 有关dockerfile\rdockerfile是用来构建镜像的脚本\n主要参考这几篇：\nhttps://www.runoob.com/docker/docker-dockerfile.html\nhttps://developer.aliyun.com/article/484262\ndocker容器启动时自动启动脚本\n编写dockerfile\r我的第一个dockerfile：\n简单做个测试，在之前做的镜像上加了条启动命令\nDockerfile （文件没有后缀)\n## Set the base image to CentOS 基于nodehexo FROM nodehexo:V4 COPY ddnsstart.sh /ddnsstart.sh ENTRYPOINT [\u0026quot;/bin/bash\u0026quot;, \u0026quot;/ddnsstart.sh\u0026quot;] 很简单:\nFROM基于nodehexo:V4镜像构建\nCOPY就是拷贝构建目录下的ddnsstart.sh到之后构建好的镜像根目录下\nENTRYPOINT会在用新镜像开启容器时再执行，这里会在执行/bin/bash里执行/ddnsstart.sh\n一个dockerfile只能有一条ENTRYPOINT，多个也只执行最后一个,CMD也是如此\n如果 Dockerfile 中如果存在多个 CMD 指令，仅最后一个生效。\n关于CMD还有些写法，比如还可以\nCMD service ssh start \u0026amp;\u0026amp; service XXX start \u0026amp;\u0026amp; tail -f /etc/passwd一起执行多道指令\n这在构建镜像的时候会被自动转换为类似：\nCMD [\u0026quot;/bin/sh\u0026quot;, \u0026quot;service ssh start\u0026quot;,\u0026quot;service XXX start\u0026quot;,\u0026quot;tail -f /etc/passwd\u0026quot;]\ntail -f /etc/passwd作用在于防止docker容器开启后立即关闭见下面段落\nCMD格式：\nCMD \u0026lt;shell 命令\u0026gt; CMD [\u0026quot;\u0026lt;可执行文件或命令\u0026gt;\u0026quot;,\u0026quot;\u0026lt;param1\u0026gt;\u0026quot;,\u0026quot;\u0026lt;param2\u0026gt;\u0026quot;,...] CMD [\u0026quot;\u0026lt;param1\u0026gt;\u0026quot;,\u0026quot;\u0026lt;param2\u0026gt;\u0026quot;,...] # 该写法是为 ENTRYPOINT 指令指定的程序提供默认参数 推荐使用第二种格式，执行过程比较明确。第一种格式实际上在运行的过程中也会自动转换成第二种格式运行，并且默认是 bin/sh\nddnsstart.sh文件\n#!/bin/bash root/ddnsAPP/ddns -c root/ddnsAPP/config.json echo \u0026quot;更新mcwrite.winotmk.com解析\u0026quot; service ssh start tail -f /etc/passwd 这里都是简单的shell命令了\nroot/ddnsAPP/ddns -c root/ddnsAPP/config.json是执行ddns更新，解析新的ip到域名上，因为我这个镜像打算放到阿里云ECI里跑，每次新拉的IP当然都不一样（一直占着一个IP会产生费用，没必要）\n同时我还执行了启动ssh服务，有的时候会用上ssh，因为我把网盘挂载到了容器内\ntail -f /etc/passwd这里起到的比较重要的占着进程的作用，详见下面：\n*关于 CMD 或 entrypoint 构建后 docker run -dit 为何容器依然秒退\nhttps://www.zhihu.com/question/344939968\n是因为使用了CMD或者entrypoint去service *** start命令作为容器启动命令，主进程执行完结束了，容器也就结束了\ndockerfile 写清楚 entrypoint 和 cmd，启动脚本如果立刻会退出，那么在最后添加 tail -f 某个日志文件。或者 监听某个端口或者进程。\n方法1: 设置容器启动时就启动服务ENTRYPOINT [\u0026ldquo;flask\u0026rdquo;, \u0026ldquo;run\u0026rdquo;, \u0026ldquo;-h\u0026rdquo;, \u0026ldquo;0.0.0.0\u0026rdquo;, \u0026ldquo;-p\u0026rdquo;, \u0026ldquo;80\u0026rdquo;]\n方法2:CMD service apache2 start \u0026amp;\u0026amp; tail -F /var/log/apache2/error.log再极端点 sleep infinite\n用dockerfile构建镜像\rdocker build -t \u0026lt;新镜像名字:标签\u0026gt; .\n比如docker build -t nodehexo:V5 .\n请不要忘记最后一个.，这表示在当前目录下构建\n用这条指令前先CD到dockerfile文件所放置的目录\n比如我先CD ./dockerbuild，因为我的文件放在用户/dockerbuild目录下面\n然后就拥有了属于构建的镜像！\n1.4.1 ENTRYPOINT与CMD的区别\rDocker 的 ENTRYPOINT 和 CMD 参数探秘\nhttps://aws.amazon.com/cn/blogs/china/demystifying-entrypoint-cmd-docker/\n1.4.2 dockerfile构建镜像时如何选择FROM镜像以减小镜像体积\rbusybox：\nhttps://blog.csdn.net/hknaruto/article/details/70229896\nalpine：\nhttps://hub.docker.com/_/alpine\nalpine包管理器APK：\nhttps://wangchujiang.com/linux-command/c/apk.html\nhttps://wiki.alpinelinux.org/wiki/Alpine_Package_Keeper\n1.5 将已有镜像打包带走/使用将打包来的镜像\rhttps://zhuanlan.zhihu.com/p/348849578\n将镜像保存为本地文件\r可以使用Docker save命令\ndocker save -o mssql-2019-with-cimb.tar mssql-2019-with-cimb 会得到一个mssql-2019-with-cimb.tar文件，就可以随身携带啦\n从文件载入镜像\n从文件载入镜像\r使用Docker load命令:\ndocker load --input mssql-2019-with-cimb.tar 1.6 docker挂载本地目录\r有关volume:https://docs.docker.com/storage/volumes/\nhttps://docs.docker.com/get-started/05_persisting_data/\nhttps://blog.csdn.net/zz00008888/article/details/131924286\n在Docker中，可以使用“-v”选项来挂载本地目录。该选项需要两个参数，分别是本地目录路径和容器内目录路径。例如，以下命令将本地目录“/home/user/app”挂载到容器内的“/app”目录中：\ndocker run -v /home/user/app:/app my_image 这将使得容器可以访问本地目录中的文件，并且任何对该目录的更改也会反映在容器中。\nDocker挂载本地目录到已有容器\n除了在容器启动时挂载本地目录外，还可以在运行时将本地目录挂载到正在运行的容器中。要实现这一点，可以使用“docker cp”命令将本地目录复制到容器中，并使用“docker exec”命令在容器中执行命令。例如，以下命令将本地目录“/home/user/data”挂载到正在运行的容器中：\ndocker cp /home/user/data my_container:/data docker exec -it my_container bash 在容器中，可以访问挂载的目录“/data”，并且任何对该目录的更改也会反映在本地文件系统中。\n1.7 其他一些操作\r# ****************************** 容器 ****************************** # # 查看正在运行的容器 $ docker ps # 查看所有容器 $ docker ps -a # 启动/停止某个容器 $ docker start/stop id/name # 以交互方式启动一个容器 $ docker start -i id/name # 进入某个容器(使用exit退出后容器也跟着停止运行) $ docker attach id/name # 启动一个伪终端以交互式的方式进入某个运行的容器（使用exit退出后容器不停止运行） $ docker exec -it id/name # 删除某个容器 $ docker rm id/name # 复制ubuntu容器并且重命名为test且运行，然后以伪终端交互式方式进入容器，运行bash $ docker run --name test -ti ubuntu /bin/bash # ****************************** 镜像 ****************************** # # 查看本地镜像 $ docker images # 删除某个镜像 $ docker rmi id/name # 基于当前目录下的Dockerfile，创建一个名为name:flag的镜像 $ docker build -t name:flag . 2. 已启动容器操作\r2.1 win10下docker给已存在的容器添加端口映射的方法\r博主再吐槽一下，这个调试阶段如此常用的修改容我端口，改起来却像游戏作弊，不觉得这个要做简单很难，怕只是没做\nhttps://mdnice.com/writing/25822ca29531424d9b68d7feb8273a82\nhttps://blog.csdn.net/Taysuesue/article/details/126706394\nhttps://www.cnblogs.com/kingsonfu/p/11578073.html\n查看容器已映射的端口（dockerdeskUI内也可看见）\ndocker port 容器ID/容器名 先停止容器\ndocker stop {容器的名称或者 id } 查看容器完整的 hash_of_the_container 数值：\ndocker inspect {容器的名称或者 id } | grep Id # 比如： docker inspect cbe26510c276 | grep Id # 会得到如下结果： # \u0026quot;Id\u0026quot;: \u0026quot;cbe26510c276fa9a4487a8c2af8cbb49410f2a5305149d2b26eb8ce37c777d00\u0026quot; 如果主机是linux（mac应该也行没测）\n打开 hostconfig.json 配置文件:\nvim /var/lib/docker/containers/{hash_of_the_container}/hostconfig.json 记得还要改 config.v2.json，改法同下面的win10\n如果是win10\n1.先找到容器的配置文件，首先我的电脑地址栏输\\wsl$\\进入到网络文件夹上,在一步一步找到容器目录\n\\\\wsl$\\docker-desktop-data\\data\\docker\\containers 2.点击进入相应容器ID文件夹，打开后修改其中的 config.v2.json 和 hostconfig.json\nhostconfig.json\n\u0026quot;PortBindings\u0026quot;:{\u0026quot;22/tcp\u0026quot;:[{\u0026quot;HostIp\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;HostPort\u0026quot;:\u0026quot;50022\u0026quot;}],\u0026quot;3306/tcp\u0026quot;:[{\u0026quot;HostIp\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;HostPort\u0026quot;:\u0026quot;53306\u0026quot;}],\u0026quot;6379/tcp\u0026quot;:[{\u0026quot;HostIp\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;HostPort\u0026quot;:\u0026quot;56379\u0026quot;}]} 这里的HostPort字面意思就是宿主机的端口，所以即：\n容器内22\u0026gt;外部5022访问\n容器内3306\u0026gt;外部53306访问\n容器内6379\u0026gt;外部56379访问\nconfig.v2.json 有两处需要添加，只修改一处不生效\n\u0026quot;ExposedPorts\u0026quot;:{\u0026quot;22/tcp\u0026quot;:{},\u0026quot;3306/tcp\u0026quot;:{},\u0026quot;6379/tcp\u0026quot;:{}} \u0026quot;Ports\u0026quot;:{\u0026quot;22/tcp\u0026quot;:[{\u0026quot;HostIp\u0026quot;:\u0026quot;0.0.0.0\u0026quot;,\u0026quot;HostPort\u0026quot;:\u0026quot;50022\u0026quot;}],\u0026quot;3306/tcp\u0026quot;:[{\u0026quot;HostIp\u0026quot;:\u0026quot;0.0.0.0\u0026quot;,\u0026quot;HostPort\u0026quot;:\u0026quot;53306\u0026quot;}],\u0026quot;6379/tcp\u0026quot;:[{\u0026quot;HostIp\u0026quot;:\u0026quot;0.0.0.0\u0026quot;,\u0026quot;HostPort\u0026quot;:\u0026quot;56379\u0026quot;}]} 不过我实际只改了这里的\u0026quot;ExposedPorts\u0026quot;貌似就行了\n然后重启docker，注意不只是重启容器，我一开始只重启容器发现白改了\n# 重启 docker service docker restart 或者在系统右下角，点击Restart重启整个 Docker 服务，然后再重启 Container 即可正常使用\n2.2 docker容器内服务开机自启动实现方案（以ssh服务为例）\r注意，2.2这段内容随着对docker和linux了解的深入觉得有不妥，但是作为学习的过程还是保留\nhttps://blog.csdn.net/qq_38603541/article/details/124028994\n因为我后续打算用类似vscode里的remote-ssh来管理容器内，也想用winscp等好用的工具可以接进来，还是有必要开个ssh\n解决方案\n1、正常我们在linux操作系统内设置服务自启动的方法一般都是使用systemctl。\nsystemctl enable ssh\n2、但是，一般在docker容器内我们一般不这么干，因为容器内没有systemctl权限……\n3、我们依然还是使用脚本的形式将ssh设为自启，只不过这个的这个脚本和我们使用Dockerfile的脚本不一样。\n4、在 /root 目录下新建一个 start_ssh.sh文件，并给予该文件可执行权限。\ntouch /root/start_ssh.sh vim /root/start_ssh.sh chmod +x /root/start_ssh.sh 5、start_ssh.sh 脚本的内容，如下：\n#!/bin/bash LOGTIME=$(date \u0026quot;+%Y-%m-%d %H:%M:%S\u0026quot;) echo \u0026quot;[$LOGTIME] startup run...\u0026quot; \u0026gt;\u0026gt;/root/start_ssh.log service ssh start \u0026gt;\u0026gt;/root/start_ssh.log #service mysql start \u0026gt;\u0026gt;/root/star_mysql.log //其他服务也可这么实现 6、将start_ssh.sh脚本添加到启动文件中\nvim /root/.bashrc 7、在 .bashrc 文件末尾加入如下内容：\n# startup run if [ -f /root/start_ssh.sh ]; then . /root/start_ssh.sh fi 8、保存后，等下次重启容器的时候，添加的服务也就跟着重启了。\ndocker容器在启动的时候，会自动执行的是~/.bashrc文件，所以，环境变量需要配置在该文件内，这样镜像启动时，可自动执行该文件，使环境变量生效。\n正确的理解是：\n/root/.bashrc会在容器启动的时候自动执行这句十分欠妥，\n准确的来讲是root用户登录bash的时候会执行，每次开新的bash shell也会执行一遍\n如果dockerfile内定义了ENTRYPOINT或者CMD执行类似：\nENTRYPOINT [ \u0026quot;/bin/bash\u0026quot;,\u0026quot;-c\u0026quot;,\u0026quot;service apache2 start\u0026quot; ] 那么对于容器来说PID 1号进程就是bash（apache是bash的子进程），也确实会跑一遍.bashrc内的内容，但是这不代表所有容器启动时一定会启动bash shell，也可能直接是个java进程，也可能是dumb-int，更多时候可能是sh shell，这应该都不会触发.bashrc\n所以如果想要在容器启动时自动启动一个服务，推荐写在dockerfile里，比如\nCOPY start.sh / ENTRYPOINT [ \u0026quot;sh\u0026quot;,\u0026quot;/start.sh\u0026quot; ] 然后再在start.sh里写上你需要启动的服务\n#!/bin/sh service ssh restart service apache2 restart 以及如果确实有很多个服务需要启，考虑使用类似docker compose启多个镜像，每个镜像跑单个服务\n2.2.1 拓展：~/.bashrc /etc/bashrc /etc/profile三个文件的区别\rhttps://segmentfault.com/q/1010000003793341\n3 打包制作自己的docker镜像(dockerfile)\rdockerfile是告诉docker engine如何构建镜像的脚本\n3.1 node.js+git+hexo镜像\r其实这部分镜像做了两遍，第一遍直接拉的官方node镜像，然后发现ssh不好装，走了很多弯路，随着对docker了解的加深，最后我自己做了dockerfile重构了这部分镜像\n3.1.1 Dockerfile\rdockerfileV02（可以没有后缀）\n#这个包将包含：node-v29.5.0 git ssh hexo #hexo环境目录/hexo/Winblog FROM debian:stable-slim LABEL maintainer=\u0026quot;winotmk\u0026quot; web=\u0026quot;md.winotmk.com\u0026quot; Ver=\u0026quot;02\u0026quot; #ADD有自动解压功能 ADD node-v20.5.0-linux-x64.tar.xz / #移动node二进制文件到目录 RUN mkdir -p /usr/local/nodejs \u0026amp;\u0026amp;\\ mv node-v20.5.0-linux-x64 /usr/local/nodejs \u0026amp;\u0026amp;\\ #mk hexo目录 mkdir -p /hexo/Winblog \u0026amp;\u0026amp;\\ apt-get update \u0026amp;\u0026amp;\\ #安装SSH 安装GIT apt-get install -y --no-install-recommends openssh-server git-core \u0026amp;\u0026amp;\\ apt-get autoremove -y \u0026amp;\u0026amp;\\ apt-get clean #node和npm环境变量 ENV PATH=\u0026quot;/usr/local/nodejs/node-v20.5.0-linux-x64/bin:$PATH\u0026quot; #安装hexo WORKDIR /hexo/Winblog RUN npm install -g hexo-cli #hexo环境变量 ENV PATH=\u0026quot;$PATH:/hexo/Winblog/node_modules/.bin\u0026quot; #更新ssh设置 COPY sshd_config /etc/ssh/ #环境变量设置 COPY .profile /root/ #设置启动脚本 COPY hexo_debian_service_start.sh /service_start.sh CMD [\u0026quot;/bin/bash\u0026quot;,\u0026quot;/service_start.sh\u0026quot;] 基本上都是些安装命令以及配置环境变量\n安装了hexo,git,ssh,node\n这是优化过了的第二版，主要是第二版使用了ADD，它基本和COPY一样，都可以把某个构建目录下的文件打入正在生成的镜像里，但当用ADD在执行 \u0026lt;源文件\u0026gt; 为 tar 压缩文件的话，压缩格式为 gzip, bzip2 以及 xz 的情况下，会自动复制并解压到 \u0026lt;目标路径\u0026gt;。说白了ADD会帮我自动解压\n在这里我还设置了ssh（但是没有配置root密码）\n而我的第一版开头：\ndockerfileV01\nFROM debian:stable-slim COPY node-v20.5.0-linux-x64.tar.xz /node-v20.5.0-linux-x64.tar.xz RUN apt-get update \u0026amp;\u0026amp;\\ apt-get install -y xz-utils --no-install-recommends \u0026amp;\u0026amp;\\ tar -xvf node-v20.5.0-linux-x64.tar.xz \u0026amp;\u0026amp;\\ mkdir -p /usr/local/nodejs \u0026amp;\u0026amp;\\ mv node-v20.5.0-linux-x64 /usr/local/nodejs \u0026amp;\u0026amp;\\ #删除xz包 apt-get purge -y xz-utils \u0026amp;\u0026amp; \\ apt-get autoremove -y \u0026amp;\u0026amp; \\ apt-get clean \u0026amp;\u0026amp; \\ #删除node-v20.5.0-linux-x64.tar.xz包 rm node-v20.5.0-linux-x64.tar.xz #node和npm环境变量 ENV PATH=\u0026quot;/usr/local/nodejs/node-v20.5.0-linux-x64/bin:$PATH\u0026quot; 当时不知道ADD的功能，使用 COPY拷贝整个.tar.xz包结果debian还没有.xz包解压功能，需要安装xz-utils详见，凭空多出好几行\n为什么要用二进制包安装呢node.js呢？\n因为实测如果用apt-get install nodejs安装，\n或者curl -fsSL https://deb.nodesource.com/setup_19.x | bash - \u0026amp;\u0026amp;\\ apt-get install -y nodejs命令出处，\n安装出来镜像体积就是会楞大出好几百MB\n3.1.2 node.js+git+hexo镜像COPY的文件\r.profile\n# ~/.profile: executed by Bourne-compatible login shells. if [ \u0026quot;$BASH\u0026quot; ]; then if [ -f ~/.bashrc ]; then . ~/.bashrc fi fi mesg n 2\u0026gt; /dev/null || true export PATH=\u0026quot;/usr/local/nodejs/node-v20.5.0-linux-x64/bin:$PATH\u0026quot; export PATH=\u0026quot;$PATH:/hexo/Winblog/node_modules/.bin\u0026quot; 为了防止镜像上云后莫名其妙的原因导致环境变量出问题，脚本里再跑一遍，这俩export PATH其实dockerfile里设置过\nsshd_config是什么\nssh的设置\n参考：https://blog.csdn.net/weixin_34910922/article/details/125193597\n主要改了两条\n#vim /etc/ssh/sshd_config PermitRootLogin yes #root登陆权限 PasswordAuthentication yes #密码权限 等于我们预先改好了配置文件，在构建的时候再把配置放入容器里面\nhexo_debian_service_start.sh\n#!/bin/bash . ~/.profile LOGTIME=$(date \u0026quot;+%Y-%m-%d %H:%M:%S\u0026quot;) echo \u0026quot;[$LOGTIME] startup run...\u0026quot; \u0026gt;\u0026gt;/start_ssh.log service ssh start \u0026gt;\u0026gt;/start_ssh.log tail -f /start_ssh.log 启动脚本，主要启动了ssh服务，并且用tail -f让这个容器一直运行以方便我们来连接\n3.1.3 开始构建镜像\r先CD到Dockerfile所在的目录\ndocker build -t hexo_debian:V02 -f dockerfileV02 . 格式是\ndocker build -t 镜像名:tag -f Dockerfile文件名 . 注意.不要落下！\n这样我们的镜像就做好了！\n本节参考资料：\n二进制手动安装node参考：\nhttps://github.com/nodejs/help/wiki/Installation\nhttps://blog.51cto.com/u_13460811/4901015\n一些关于dockerfile指令的说明：\n较详细： https://yeasy.gitbook.io/docker_practice/image/dockerfile/copy\nhttps://blog.csdn.net/qq_35528657/article/details/127244194\nhttps://www.runoob.com/docker/docker-dockerfile.html\n在dockerfile里用apt-get包管理的建议：\nhttps://ubuntu.com/blog/we-reduced-our-docker-images-by-60-with-no-install-recommends\nhttps://www.metricfire.com/blog/how-to-build-optimal-docker-images/\nhexo所需环境安装说明：\nhttps://hexo.io/zh-cn/docs/index.html\n3.1.4 测试镜像功能\r来启个容器试试！\ndocker run -it -d -p 22:22 --name hexo_debian hexo_debian:V02 这里开放了22端口来方便验证ssh服务和登录ssh没有问题\n启动成功！\n容器内执行来验证服务状态都正常：\nssh node -v git -v 输出：\n可以看见一切正常！\n3.1.5 设置和再打包镜像\r设置\r毕竟自用镜像，我习惯直接把比如ssh密钥之类全都配置好，再commit为一个新镜像，以后就再也不用输密码了，这样确实不安全，但是自己的hexo博客而已，何必为难自己呢\n接下来设置root密码和重启ssh服务\npasswd root #然后敲自己设置的密码 service ssh restart 尝试使用PuTTY进行SSH root@127.0.0.1登录：\n成功!!!\n接下来配置git和ssh，要生成新的ssh公钥\n详见：https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent\nssh-keygen -t ed25519 -C \u0026quot;github邮箱@qq.com\u0026quot; 得到密钥默认在/root/.ssh/id_ed25519.pub\n在Github的头像点Setting然后点右上角击New SSH key，把id_ed25519.pub内容粘贴进即可！\n测试SSH连接：\nssh -T git@github.com 这样就连上了！\n需要进行一个小设置：\ngit config --global user.email \u0026quot;you@example.com\u0026quot; 这样以后使用hexo d的时候就能无脑部署了\n再打包\r为了存下我们配置好的连接，制作成最终镜像方便eci云上调用，把现有容器再commit一次\ndocker commit hexo_debian hexo_debian:V02-configured 成了！得到了hexo_debian:V02-configured作为我最后准备上传至ECI云的镜像\n3.1.6 附一些命令参考\r如何用ssh连接 docker 容器\rhttps://blog.csdn.net/weixin_34910922/article/details/125193597\n1.修改root密码\n$ passwd root 输入密码：123456(自己决定) 2.安装Openssh\nsudo apt-get update # 更新源 sudo apt-get upgrade # 更新系统软件 apt-get install -y openssh-server 3.修改ssh配置,允许root登录\nhttps://blog.csdn.net/weixin_43343144/article/details/102494830\n【非常重要】在/etc/ssh/ssh_config中没有PermitRootLogin yes选项的话，就要在sshd_config文件中寻找！\nvim /etc/ssh/sshd_config PermitRootLogin yes #root登陆权限 PasswordAuthentication yes #密码权限 4.启动ssh服务/重启服务\nservice ssh start service ssh restart 安装hexo\rnpm install hexo-cli -g SSH远程登录这个镜像\r之前在本机docker内已经配好了ssh服务，讲道理应该启动则开启ssh但是不知为啥没有自动启动，以后再研究吧\n打开Workbench远程连接，启动ssh\n由于我启用ECI时开通了弹性公网IP，所以我可以通过这个IP:22用ssh来登录\n使用PuTTY工具登录成功！！\n多么令人振奋的一刻\n3.2 vsftpd镜像\r这个镜像比较简单，只跑ftp服务，主要在写作的时候方便上传图片\n3.2.1 Dockerfile\rvsftpd_dockerfileV01\n#这个包将包含：vsftp（root登录） FROM debian:stable-slim LABEL maintainer=\u0026quot;winotmk\u0026quot; web=\u0026quot;md.winotmk.com\u0026quot; Ver=\u0026quot;01\u0026quot; RUN apt-get update \u0026amp;\u0026amp;\\ apt-get install -y vsftpd --no-install-recommends \u0026amp;\u0026amp;\\ apt-get autoremove -y \u0026amp;\u0026amp;\\ apt-get clean \u0026amp;\u0026amp;\\ echo \u0026quot;root:yourpasswd\u0026quot; | chpasswd COPY ftpusers /etc/ COPY vsftpd.conf /etc/ COPY service_start.sh /service_start.sh CMD [\u0026quot;/bin/bash\u0026quot;,\u0026quot;/service_start.sh\u0026quot;] 比较简单的dockerfile，就装了个vsftpd服务，然后拷贝了一些设置文件\n如果要在dockerfile里配置用户密码可以这么写：\necho \u0026quot;root:yourpasswd\u0026quot; | chpasswd 3.2.2 vsftpd镜像COPY的文件\rservice_start.sh\n#!/bin/bash LOGTIME=$(date \u0026quot;+%Y-%m-%d %H:%M:%S\u0026quot;) echo \u0026quot;[$LOGTIME] startup run...\u0026quot; \u0026gt;\u0026gt;/start_vsftpd.log service vsftpd start \u0026gt;\u0026gt;/start_vsftpd.log tail -f /start_vsftpd.log 简单的服务启动脚本，使用tail -f来维持住进程\nftpusers\nroot前加个#以启用root登录\n# /etc/ftpusers: list of users disallowed FTP access. See ftpusers(5). #root daemon bin sys sync games man lp mail news uucp nobody vsftpd.conf\nftp设置文件，这个文件内容很多只些下修改的部分\nlisten=NO listen_ipv6=YES anonymous_enable=NO local_enable=YES write_enable=YES dirmessage_enable=YES use_localtime=YES connect_from_port_20=YES pam_service_name=vsftpd utf8_filesystem=YES *关于修改vsftpd的端口\nhttps://askubuntu.com/questions/37058/how-to-change-vsftpd-default-port\nvsftpd.conf里的设置不是完全设置，可以自己增加字段\nlisten_port=234 ftp_data_port=235 pasv_min_port=30000 pasv_max_port=31000 来设置端口\n注意FTP默认20传输数据，21用来listen，所以改得话干脆两个都改吧\n*这里遇到过一个小坑坑\n构建器报错，一直卡在Starting FTP server: vsftpdvsftpd failed - probably invalid config. ... (warning).\n自己在容器内运行service vsftpd start的时候同样如此，一般这样是因为vsftpd.conf文件设置错了，可神奇的是我只要打开dockerDesktop的Files文件管理把vsftpd.conf打开再保存一下就可以成功运行service vsftpd start\n我发现这个文件的格式是UTF-8 CRLF\n修改为LF\n即可顺利启动vsftpd服务\n参考：\nhttps://www.cnblogs.com/Dreamcho/p/10805690.html\n如果要在dockerfile里加用户：\nhttps://blog.csdn.net/u010275850/article/details/120587850\n3.3 ddns镜像\r这个镜像更简单？只在启动的时候跑一个ddns\n但是我却在这里卡了很久\n原因之一是因为一开始选用的ddns软件本地跑得好好的，在阿里云上总是报错，log显示已经修改了a记录但是自己去一看啥也没有，很是困惑，所以换了个软件实现\n最开始使用的是这个软件，配置方便\nhttps://github.com/NewFuture/DDNS\n参考：\nhttps://blog.csdn.net/biao0309/article/details/117202951\n无奈阿里云上即便是用官方提供的镜像newfuture/ddns也会报错（恼\n所以我改用ddns-go:\nhttps://github.com/jeessy2/ddns-go\n先贴上官方镜像的层：\njeessy/ddns-go\n我们的新镜像将基于官方镜像来做\n3.3.1 dockerfile\rddns-go_dockerfileV01\nFROM jeessy/ddns-go LABEL maintainer=\u0026quot;winotmk\u0026quot; web=\u0026quot;md.winotmk.com\u0026quot; Ver=\u0026quot;01\u0026quot; COPY ddns_start.sh / COPY ddns_go_config.yaml / ENV DDNS_URL= ENTRYPOINT [ \u0026quot;sh\u0026quot;,\u0026quot;/ddns_start.sh\u0026quot; ] CMD [ \u0026quot;\u0026quot; ] 这里做了一个变量$DDNS_URL来定义我想要dns的域名(当然这个域名我得拥有)\nENTRYPOINT和CMD的设置会覆盖掉的之前镜像内的设置\n我不确定CMD [ \u0026quot;\u0026quot; ]是否有必要，但总之我想使官方镜像里的CMD失效，从结果上来看管用\n3.3.2 ddns镜像COPY的文件\rddns_go_config.yaml\ndnsconf: - ipv4: enable: true gettype: url url: https://myip4.ipip.net,https://ddns.oray.com/checkip,https://ip.3322.net,https://4.ipw.cn netinterface: \u0026quot;\u0026quot; cmd: \u0026quot;\u0026quot; domains: - null.winotmk.com ipv6: enable: false gettype: netInterface url: https://speed.neu6.edu.cn/getIP.php,https://v6.ident.me,https://6.ipw.cn netinterface: \u0026quot;\u0026quot; cmd: \u0026quot;\u0026quot; ipv6reg: \u0026quot;\u0026quot; domains: - \u0026quot;\u0026quot; dns: name: alidns id: 阿里云的AccessKey ID secret: 阿里云的AccessKey secret ttl: \u0026quot;\u0026quot; user: username: \u0026quot;\u0026quot; password: \u0026quot;\u0026quot; webhook: webhookurl: \u0026quot;\u0026quot; webhookrequestbody: \u0026quot;\u0026quot; webhookheaders: \u0026quot;\u0026quot; notallowwanaccess: true 这个是ddns-go的配置文件，第一次启动会在本地:9876打开个web界面，保存设置后会在root中生成这个文件，这里我直接引入这个文件是希望后面能用sed命令对文件的domains字段进行修改\nddns_start.sh\n#!/bin/sh LOGTIME=$(date \u0026quot;+%Y-%m-%d %H:%M:%S\u0026quot;) echo \u0026quot;[$LOGTIME] startup run...\u0026quot; \u0026gt;\u0026gt;/start_ddns.log cd / if [ \u0026quot;$DDNS_URL\u0026quot; = \u0026quot;\u0026quot; ] then echo \u0026quot;DDNS_URL is not set!\u0026quot; \u0026gt;\u0026gt;/start_ddns.log tail -f /start_ddns.log else sed -i \u0026quot;s/null.winotmk.com/$DDNS_URL/g\u0026quot; ddns_go_config.yaml #chmod 777 ddns_go_config.yaml sleep 3 /app/ddns-go -l :9876 -f 300 -c /ddns_go_config.yaml echo \u0026quot;已执行更新[$DDNS_URL]解析\u0026quot; \u0026gt;\u0026gt;/start_ddns.log tail -f /start_ddns.log fi 在这个脚本里会判断$DDNS_URL是否为空，空的话直接输出需要$DDNS_URL设置\n如果不为空的话会通过sed替换字符，这里设置文件内默认写得是null.winotmk.com\n用这种方式去直接修改设置文件，是因为我没找到这个软件是否能直接用环境变量来定义解析到的域名\n关于用sed替换congif.json设置内的字段：\n如何使用sed:\nhttps://linux.cn/article-11367-1.html\n如何在sed命令内使用变量\nhttps://www.cnblogs.com/muahao/p/6874412.html\n判断变量是否为空的方法：\nhttps://cloud.tencent.com/developer/article/1721905\n4 docker镜像打包并上传到阿里云镜像库ARK\r将自己的镜像上传至阿里云：\n阿里云提供容器镜像服务，我自己玩开通个人实例即可\nhttps://cr.console.aliyun.com/cn-shanghai/instances\n建立一个自己的仓库，然后就能看到示例说明，我们就能把自己的镜像上传了\n4.1 将镜像推送到Registry\r$ docker login --username=*****@qq.com registry.cn-shanghai.aliyuncs.com $ docker tag [ImageId] registry.cn-shanghai.aliyuncs.com/******:[镜像版本号] $ docker push registry.cn-shanghai.aliyuncs.com/******:[镜像版本号] tag是类似复制一份且重命名镜像，push是上传（不知道为什么要重命名\n针对上面的3个镜像，分别是：node.js+git+hexo,vsftpd,ddns-go\n我分别tag成了：\nregistry-vpc.cn-shanghai.aliyuncs.com/******:debian_V02_configured #应该写成:hexo_debian_V02_configured的，漏了。。算了 registry-vpc.cn-shanghai.aliyuncs.com/******:vsftpd_debian_V01 registry-vpc.cn-shanghai.aliyuncs.com/******:ddns_go_V01 再分别push即可\n4.2 在阿里云上使用容器实例（ECI）运行镜像\r阿里云ECI提供这个服务，你可以直接用现有的镜像也可以自己上传（就是上一步镜像服务里上传的镜像）按秒收费！不过作为hexo这种启用\u0026gt;生成\u0026gt;部署\u0026gt;关闭的服务来说，花不了几毛钱\n然后就能看到我们上传的镜像\n5 eci容器创建模板和eci命令行工具使用\r参考文章这两篇足够:\nhttps://github.com/aliyuneci/eci-client-doc/blob/main/eci_run.md\nhttps://help.aliyun.com/document_detail/186961.html\n5.1 eci简介\rhttps://www.aliyun.com/product/eci\nECI是 Serverless 和容器化的弹性计算服务。您无需管理底层 ECS 服务器，只需要提供打包好的镜像，即可运行容器，与阿里云容器服务无缝对接并仅为容器实际运行消耗的资源付费。\n博主：比ECS云服务器灵活得多，本地用docker制作好镜像以后，上传，随启随用，用完就释放，成本可以很低,但如果连开一个月，并不会比ECS划算，详见本站ECI价格计算附表\n5.2 用模板创建eci\r询问过阿里云客服，说在web控制面版里的这个功能已经下线了\n不过没关系，我们还有命令行工具！\n安装：\nsudo bash -c \u0026quot;$(curl -s https://eci-docs.oss-cn-beijing.aliyuncs.com/eci-client/1.0/install.sh)\u0026quot; 然后配置你的阿里云信息\neci config set-context \\ --access-key-id **** \\ --access-secret **** \\ --region-id cn-shanghai \\ --security-group-id sg-**** \\ --v-switch-id vsw-**** 要指定自己的access-key-id和access-secret，地区以及安全组和虚拟交换机\n建议这些东西在web上的控制台里准备好，会直观很多\n然后就可以直接创建一个容器了\neci run -n myeci centos:7 sleep 3600 指令很像docker run喝！很好，很有精神\n我们还可以编写yaml模板文件\n然后执行\neci run -f eci.yaml -w 20 需要注意的事，如果使用了-f xxxx.yaml模板文件，除了-f和-w选项以外，其他选项都将被忽略，因为这些选项都是针对实例中某个容器的，如果模板中定义了多个容器，ECI将不知道这些选项应该作用于哪个容器\n那么我自己的启动模板是这样的：\nhexo_debian_eci.yaml\nContainerGroupName: eci-hexo Cpu: \u0026quot;0.5\u0026quot; Memory: \u0026quot;1\u0026quot; Container: - Name: hexo Image: registry-vpc.cn-shanghai.aliyuncs.com/****:debian_V02_configured Command: [\u0026quot;/bin/bash\u0026quot;,\u0026quot;/service_start.sh\u0026quot;] ImagePullPolicy: IfNotPresent Cpu: \u0026quot;0.5\u0026quot; Memory: \u0026quot;1\u0026quot; VolumeMount: - Name: hexo MountPath: /hexo ReadOnly: false - Name: vsftpd Image: registry-vpc.cn-shanghai.aliyuncs.com/****:vsftpd_debian_V01 Command: [\u0026quot;/bin/bash\u0026quot;,\u0026quot;/service_start.sh\u0026quot;] ImagePullPolicy: IfNotPresent VolumeMount: - Name: hexo MountPath: /hexo ReadOnly: false - Name: ddns Image: registry-vpc.cn-shanghai.aliyuncs.com/****:ddns_go_V01 ImagePullPolicy: IfNotPresent EnvironmentVar: - FieldRefFieldPath: \u0026quot;\u0026quot; Key: DDNS_URL Value: mdwrite.winotmk.com Volume: - Name: hexo Type: NFSVolume NFSVolume: Server: ****.cn-shanghai.nas.aliyuncs.com Path: / ReadOnly: false 是不是挺像docker compose~\ncpu只给了0.5,Memory 1G，足够了，之前这套可是在树莓派3B上跑得溜溜得呢\n对于阿里云ECI，CPU和Memory直接和成本挂钩，能少就少吧\n这里启了上面做好的3个镜像，分别实现hexo，ftp，还有ddns\nCommand:写法目测类似dockerfile里的CMD，我习惯做好启动sh脚本就是为了方便这里再调用\n最后一段声明了我的一个阿里云NAS卷，卷里的内容就是我的hexo目录\n然后把它挂到hexo和ftp镜像上就好了\n值得一提的是ddns镜像还写了个环境变量DDNS_URL值为mdwrite.winotmk.com，这会修改ddns-go的解析配置\n然后执行\neci run -f hexo_debian_eci.yaml -w 20 不出意外的话会返回一个eci的id编号，打开web会发现已经创建成功了！\n6 hexo本地编辑环境设置————如何用VSCode舒服的写MD文档\r6.1 VSCodeSSH FS插件配置\r简单配置一下服务器地址和用户密码就可以把远程目录映射到工作区里，很方便\n这里可以看到/root/hexo/Winblog目录下是我挂载的阿里云NAS网盘了\n6.2 Markdown Paste插件配置\r一个很方便的在VScode里直接粘图的插件\n配置：\r会用时间来命名图片\n然后会将图片放入MD文件目录下的images下\n然后文件》首选项》键盘快捷方式\n我将快捷键设置为ctrl+alt+a\n配置完成！\n使用：\r截图我习惯用Sinpaste，按F1就能截图\n然后点右下角复制按钮\n在VScode的markdown文档里ctrl+alt+a就能粘图了！\n图片文件会自动保存!\n6.2 VSCode的SFTP插件配置\r先把images文件夹单独放到工作区里\n然后在Ctrl+Shift+P打开命令面板，运行SFTP: config命令\nsftp.json目录下会出现一个名为的基本配置文件.vscode\n然后编辑\nsftp.json\n{ \u0026quot;name\u0026quot;: \u0026quot;Hexo_images\u0026quot;, \u0026quot;host\u0026quot;: \u0026quot;mdwrite.winotmk.com\u0026quot;, \u0026quot;protocol\u0026quot;: \u0026quot;ftp\u0026quot;, \u0026quot;port\u0026quot;: 21, \u0026quot;username\u0026quot;: \u0026quot;root\u0026quot;, \u0026quot;password\u0026quot;: \u0026quot;****\u0026quot;, \u0026quot;remotePath\u0026quot;: \u0026quot;/hexo/Winblog/source/images\u0026quot;, \u0026quot;useTempFile\u0026quot;: false, \u0026quot;openSsh\u0026quot;: false, \u0026quot;uploadOnSave\u0026quot;: false, \u0026quot;watcher\u0026quot;: { \u0026quot;files\u0026quot;: \u0026quot;**/*\u0026quot;, \u0026quot;autoUpload\u0026quot;: true, \u0026quot;autoDelete\u0026quot;: true }, \u0026quot;syncOption\u0026quot;: { \u0026quot;delete\u0026quot;: true } } \u0026quot;watcher\u0026quot;是用来设置自动更新的\n这样我们在md里粘了图，就会自动上传到到ftp目录上\n参考：\nhttps://marketplace.visualstudio.com/items?itemName=Natizyskunk.sftp#remote-explorer\n开启watcher模式，实现增加文件时自动上传目录同步\nhttps://github.com/Natizyskunk/vscode-sftp/blob/master/FAQ.md#automatically-sync-both-ways-without-user-interaction\n","date":"2023-08-05T00:00:00Z","permalink":"http://localhost:10354/posts/docker01/","title":"Docker01_用docker构建hexo和vsftpd与ddns镜像并且用阿里云容器服务ECI运行"},{"content":"边栏显示文章列表效果\r我还奇怪next没用提供这样的功能，文章一多一篇篇翻实在是累，还好找到了有人实现最近文章的功能，那么做文章列表也就同理了\n我修改过的代码\n首先是：\nsidebar.njk\r/hexo-theme-next/layout/_macro/sidebar.njk\n在最后一个{% endif %}后面加入\n{% if theme.recent_posts.enable %}\r\u0026lt;div class=\u0026quot;links-of-blogroll\u0026quot; style=\u0026quot;margin-top:20px; border-style:dotted none none none; padding-top:5px; text-align:left;padding-left: 20px; padding-right: 10px; padding-bottom: 5px;\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;links-of-blogroll-title\u0026quot; style=\u0026quot;padding-bottom: 5px; padding-top: 5px; padding-left: 0px; padding-right: 20px; font-size: 1.6em; argin-right: 5px;\u0026quot;\u0026gt;\r\u0026lt;!-- 选择合适的icon --\u0026gt;\r{%- if theme.recent_posts.icon %}\u0026lt;i class=\u0026quot;{{ theme.recent_posts.icon }}\u0026quot; aria-hidden=\u0026quot;true\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;{%- endif %}\r\u0026lt;b style=\u0026quot;font-size: 0.65em; padding-left: 8px; position: relative; top: -2px;\u0026quot;\u0026gt;{{ theme.recent_posts.description }}\u0026lt;/b\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;ul class=\u0026quot;links-of-blogroll-list\u0026quot;\u0026gt;\r\u0026lt;!-- 文章排序规格,-updated 按照文章更新时间倒排 --\u0026gt;\r{% set posts = site.posts.sort('-updated').toArray() %}\r\u0026lt;!-- 显示20数目的文章 --\u0026gt;\r{% for post in posts.slice('0','20') %}\r\u0026lt;li class=\u0026quot;postsSidebarNumb\u0026quot; style=\u0026quot;text-indent: -1em;\u0026quot;\u0026gt;\r\u0026lt;a href=\u0026quot;{{ url_for(post.path) }}\u0026quot; title=\u0026quot;{{ post.title }}\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;{{ post.title }}\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r{% endif %}\r出于美观我把一些css代码内嵌进去了其实不推荐这样做（寄\n_config.yml\r/hexo-theme-next/_config.yml\n# 近期文章配置 recent_posts:\renable: true\ricon: fab fa-markdown\rdescription: 文章列表\rmain.styl\r/hexo-theme-next/source/css/main.styl\n是因为我想给文章列表加上计数，直接在css里用伪类做（要不是伪类不能html内嵌写进去我也不写这里\n//侧边栏计数伪类\rbody {\rcounter-reset: postsSidebarNumbsection; }\r.postsSidebarNumb::before {\rcounter-increment: postsSidebarNumbsection;\rcontent: counter(postsSidebarNumbsection) \u0026quot;: \u0026quot;;\r}\r一些搜集资料\rps在查找的过程中发现提到这些的多半是next主题，而且别人的next主题都挺有意思的啊想搬！（爬\n资料01：Hexo博客：(7)给NexT主题添加最新文章模块\r首先是这篇\nhttps://pickear.github.io/2020/04/12\n提到了：\nnext/layout/_macro/sidebar.swig ,这个负责渲染侧边栏。在sidebar.swig的if theme.links的end if后面添加以下代码:\n{% if theme.recent_posts %}\r\u0026lt;div class=\u0026quot;links-of-blogroll motion-element {{ \u0026quot;links-of-blogroll-\u0026quot; + theme.recent_posts_layout }}\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;links-of-blogroll-title\u0026quot;\u0026gt;\r\u0026lt;!-- modify icon to fire by szw --\u0026gt;\r\u0026lt;i class=\u0026quot;fa fa-history fa-{{ theme.recent_posts_icon | lower }}\u0026quot; aria-hidden=\u0026quot;true\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\r{{ theme.recent_posts_title }}\r\u0026lt;/div\u0026gt;\r\u0026lt;ul class=\u0026quot;links-of-blogroll-list\u0026quot;\u0026gt;\r{% set posts = site.posts.sort('-date') %}\r{% for post in posts.slice('0', '5') %}\r\u0026lt;li\u0026gt;\r\u0026lt;a href=\u0026quot;{{ url_for(post.path) }}\u0026quot; title=\u0026quot;{{ post.title }}\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;{{ post.title }}\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r{% endif %}\r然后在NexT主题目录下的_config.yaml配置文件，添加下面配置:\nrecent_posts_title: 最新文章\rrecent_posts_layout: block\rrecent_posts: true\r然而实际效果是只会显示“最新文章”几个字\n查了得知\nNexT 的架構檔案格式從 swig 改成 njk，照著舊的文章貼上不會成功\n资料02：[Day33] Hexo x NexT - 顯示最新文章、導入Google Analytics 的坑\r接着是这篇，感谢提到了next主题架构更变的问题\nhttps://ithelp.ithome.com.tw/articles/10283488?sc=iThomeR\n左側選單顯示最新文章\nNexT 已經有 hexo-related-popular-posts 套件來顯示最新文章列表的功能，但是這個套件似乎沒辦法正常運作，網路上有不少教學文章，但是 NexT 的架構檔案格式從 swig 改成 njk，照著舊的文章貼上不會成功，設定步驟如下：\n在 sidebar.njk 檔案裡面加入下段程式碼（跟 swig 版本就只差了一個 .toArray() ）\n{%- if theme.recent_posts %}\r\u0026lt;div class=\u0026quot;links-of-blogroll motion-element {{ \u0026quot;links-of-blogroll-\u0026quot; + theme.recent_posts_layout }}\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;links-of-blogroll-title\u0026quot;\u0026gt;\r\u0026lt;!-- 設定你要的fa fa icon--\u0026gt;\r\u0026lt;i class=\u0026quot;fa fa-history fa-{{ theme.recent_posts_icon | lower }}\u0026quot; aria-hidden=\u0026quot;true\u0026quot; style=\u0026quot;margin: 1rem 0.25rem 0.5rem 0\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\r{{ theme.recent_posts_title }}\r\u0026lt;/div\u0026gt;\r\u0026lt;ul class=\u0026quot;links-of-blogroll-list\u0026quot;\u0026gt;\r{%- set posts = site.posts.sort('-date') %}\r{%- for post in posts.slice('0', '5').toArray() %}\r\u0026lt;li\u0026gt;\r\u0026lt;a href=\u0026quot;{{ url_for(post.path) }}\u0026quot; title=\u0026quot;{{ post.title }}\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;{{ post.title }}\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{%- endfor %}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r{%- endif %}\r资料03: Hexo-NexT 后续优化\rhttps://blog.yileaf.com/posts/15baca53/\n我最后使用的基本上参考了这篇的代码\n侧边栏添加近期文章\n1.打开blog\\source\\_data\\sidebar.njk文件，加入以下代码：\n{% if theme.recent_posts.enable %}\r\u0026lt;div class=\u0026quot;links-of-blogroll\u0026quot;\u0026gt;\r\u0026lt;div class=\u0026quot;links-of-blogroll-title\u0026quot;\u0026gt;\r\u0026lt;!-- 选择合适的icon --\u0026gt;\r{%- if theme.recent_posts.icon %}\u0026lt;i class=\u0026quot;{{ theme.recent_posts.icon }}\u0026quot; aria-hidden=\u0026quot;true\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;{%- endif %}\r{{ theme.recent_posts.description }}\r\u0026lt;/div\u0026gt;\r\u0026lt;ul class=\u0026quot;links-of-blogroll-list\u0026quot;\u0026gt;\r\u0026lt;!-- 文章排序规格,-updated 按照文章更新时间倒排 --\u0026gt;\r{% set posts = site.posts.sort('-updated').toArray() %}\r\u0026lt;!-- 显示四条近期文章 --\u0026gt;\r{% for post in posts.slice('0', '4') %}\r\u0026lt;li\u0026gt;\r\u0026lt;a href=\u0026quot;{{ url_for(post.path) }}\u0026quot; title=\u0026quot;{{ post.title }}\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;{{ post.title }}\u0026lt;/a\u0026gt;\r\u0026lt;/li\u0026gt;\r{% endfor %}\r\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r{% endif %}\r2.主题config.yml\n# 近期文章配置 recent_posts:\renable: true\ricon: fas fa-history\rdescription: 近期文章\r","date":"2023-07-27T00:00:00Z","permalink":"http://localhost:10354/posts/next%E4%B8%BB%E9%A2%98%E5%A2%9E%E5%8A%A0%E8%BF%91%E6%9C%9F%E6%96%87%E7%AB%A0%E4%BE%A7%E8%BE%B9%E6%A0%8F/","title":"next主题增加近期文章侧边栏"},{"content":"树莓派CM4的\ropenWrt web界面安装中文\rhttps://www.jianshu.com/p/da01ce070688\n更新包目录：\nopkg update\r这里一开始我不行，ping1.1.1.1和ping8.8.8.8都ping不通，然后忽然想起自己的科学梯子路由网关是192.168.50.4\n改之!!\n可能还不行\n这俩防火墙设置一下\n如果还不行\nDNS记得指定一下\n这下就能通了\nPS也可以点配置opkg，然后加一条\nsrc/gz openwrt_packages https://mirrors.ustc.edu.cn/openwrt/releases/22.03.5/packages/aarch64_cortex-a72/packages/\r把源换为国内\n然后\nopkg install luci-i18n-base-zh-cn\r提示\nConfiguring luci-i18n-base-zh-cn\r再回来看web界面就已经是中文了\n如果要开启sftp传输服务\rhttps://github.com/twn39/code/issues/279\n开启sftp的话可以很方便用WinSCP登录，文件管理神器\n那么如何启用 sftp 服务呢？先安装对应的软件：\nopkg install vsftpd openssh-sftp-server\n设置系统开启后自动启动 sftp 服务：\n/etc/init.d/vsftpd enable\r启动 sftp 服务：\n/etc/init.d/vsftpd start\r这样 Openwrt 就已经启用了 sftp 服务了，可以使用客户端进行文件的传输。\n装网卡驱动\r我的CM4拓展板子是微雪的这个\nhttps://www.waveshare.net/wiki/CM4-DUAL-ETH-MINI\n有两个网口ETH0是原生ETH1是PCIe转出来的，需要安装RTL8111H芯片的网卡驱动，查了一下软件包里是有的\nhttps://openwrt.org/packages/pkgdata/kmod-r8169\n那么就好办了\n安装就行了：\nopkg install kmod-r8169\r安装完成以重启openwrt我们看到这里已经读到了eth1口\n设置路由器WAN口\r添加新端口，设备选装好驱动以后出现的eth1，协议我选pppoe因为我拿路由拨号\n如果要自己加安装包：\r放到一个tmp目录里\nCD到tmp目录\nopkg install *.ipk\r关于扩容挂载点\r参考资料：\nhttps://www.jianshu.com/p/e83459242afb\nhttps://blog.csdn.net/ls0111/article/details/128769859\nPS我选的是树莓派cpu对应的ext4文件系统的固件，SQUASHFS就不碰了不熟悉\n首先安装安装cfdisk，注意这里要先更新下opkg\nopkg update\ropkg install cfdisk\r然后打开cfdisk\ncfdisk\r但是我打不开\n比如我的这块硬盘是内置EMMC硬盘, 显示名称是/dev/mmcblk0.\n一般的内置硬盘应该是/dev/sda之类的.\n使用cfdisk命令，进入分区页面\ncfdisk /dev/mmcblk0\r如果普通是内置硬盘\ncfdisk\r按照参考资料中的教程一路继续\n做到格式化新分区就可以了，注意mmcblk0p3要替换成自己的盘符\nmkfs.ext4 /dev/mmcblk0p3\r运行\nfdisk -l\r或者\ndf -h\r命令，查看是否成功创建新分区。\n然后在Luci web界面里面增加挂载点：\n我是直接从OpenWrt官网下的，不是修改版，所以木有这个选项。\nopkg update\ropkg install block-mount\r重启路由，界面会有挂载点出现，进入\n挂载刚才格式化的硬盘以后\n复制这段\nmkdir -p /tmp/introot\rmkdir -p /tmp/extroot\rmount --bind / /tmp/introot\rmount /dev/sda1 /tmp/extroot\rtar -C /tmp/introot -cvf - . | tar -C /tmp/extroot -xf -\rumount /tmp/introot\rumount /tmp/extroot\r其中的\nmount /dev/sda1 /tmp/extroot\r要改为\nmount /dev/mmcblk0p3 /tmp/extroot\r满血了！！\n","date":"2023-06-23T00:00:00Z","image":"http://pictures.winotmk.com/%E6%A0%91%E8%8E%93%E6%B4%BE%E8%B7%AF%E7%94%B1%E5%99%A8/2025-02-27-23-38-00_04ccdd2b.png","permalink":"http://localhost:10354/posts/%E6%A0%91%E8%8E%93%E6%B4%BE%E8%B7%AF%E7%94%B1%E5%99%A8/","title":"树莓派路由器"},{"content":"\n挖个坑。。。\n","date":"2023-06-18T00:00:00Z","permalink":"http://localhost:10354/posts/%E6%B5%81%E9%87%8F%E5%BC%82%E5%B8%B8%E6%8E%92%E6%9F%A5/","title":"流量异常排查"},{"content":"生成秘钥\rssh-keygen -t ed25519 -C \u0026quot;550330147@qq.com\u0026quot;\r邮箱自然是我的git注册邮箱\n如果修改passphrade密码\rssh-keygen -p -f ~/.ssh/id_ed25519\r直接enter即密码为空，这是秘钥的密码\n复制秘钥到github\r打开/root/.ssh/id_ed25519.pub\n复制到这里\nhttps://github.com/settings/ssh/new\nPS官方已不推荐用rsa加密\n测试\rssh -T git@github.com\r这里输入yes\n成功！\n","date":"2023-06-18T00:00:00Z","image":"http://pictures.winotmk.com/%E7%94%9F%E6%88%90%E7%A7%98%E9%92%A5%E8%BF%9E%E6%8E%A5%E8%87%B3github_%E7%94%A8%E6%9D%A5%E6%8E%A8hexo/2025-02-27-23-31-30_51beb5cc.png","permalink":"http://localhost:10354/posts/%E7%94%9F%E6%88%90%E7%A7%98%E9%92%A5%E8%BF%9E%E6%8E%A5%E8%87%B3github_%E7%94%A8%E6%9D%A5%E6%8E%A8hexo/","title":"生成秘钥连接至github————用来推hexo"},{"content":"需求\r注意Mesh和Texture前加了编号\n工作需要整理目录文件，要将多组资产目录（Assets01,Assets02,Assets03\u0026hellip;内的Resource目录下的Texture和Mesh目录加编号)\n感觉这是一个可以用批处理脚本做到的事情，所以稍微研究了一下\n改名实现\r如果单只是改名其实很简单，只需要几行即可实现：\n@echo off\rfor /f \u0026quot;delims=\u0026quot; %%a in ('dir /ad/s/b \u0026quot;Mesh\u0026quot;') do ren \u0026quot;%%~a\u0026quot; 01-Mesh\rfor /f \u0026quot;delims=\u0026quot; %%b in ('dir /ad/s/b \u0026quot;Texture\u0026quot;') do ren \u0026quot;%%~b\u0026quot; 00-Texture\rpause\r@echo off打开批处理黑窗口\nfor in do常用在查找匹配，满足条件后执行\ndir /ad/s/b \u0026quot;Mesh\u0026quot;这行可以参考dir命令的用法，/ab在这里是只显示目录（如果是要显示文件是/a-d）/s显示目录和包含子目录，/b不显示日期大小等其他信息，\u0026quot;Mesh\u0026quot;会列出包含Mesh目录\npause这里会暂停一下按任意键继续\n所以连起来就是列出包含Mesh和Texture的目录，然后用ren改名\nSVN Rename批处理\r然而上面的简单改名这对于我遇到的实际情况不理想，有些资源是在SVN目录库里的，对于SVN来说，直接用ren等于删除Mesh旧目录，再新添加一个00-Mesh新目录，这会来带几个问题：\nlog丢失，历史版本找不回来 如果文件多，占用空间很大，浪费大家带宽（每个人update会重新下载一遍） 所以最好是用SVN的命令来进行操作\n然后发现用svn mv oldname newname就能完成\nsvn mv Mesh 00-Mesh\r移动，重命名，对svn来说都是这一个命令\n所以大致思路就是用for in do来找到Mesh和Texture文件夹，然后用变量来做oldname和newname\n@echo off\rsetlocal EnableDelayedExpansion\rfor /f \u0026quot;delims=\u0026quot; %%b in ('dir /ad/s/b \u0026quot;Mesh\u0026quot;') do (\rset \u0026quot;oldm=%%b\u0026quot;\rset \u0026quot;newm=!oldm:Mesh=00_Mesh!\u0026quot;\recho ------旧Mesh目录名称\recho !oldm!\recho ------新Mesh目录名称\recho !newm!\recho ------Mesh改名中...\rsvn mv !oldm! !newm!\r)\rfor /f \u0026quot;delims=\u0026quot; %%b in ('dir /ad/s/b \u0026quot;Texture\u0026quot;') do (\rset \u0026quot;oldt=%%b\u0026quot;\rset \u0026quot;newt=!oldt:Texture=01_Texture!\u0026quot;\recho ------旧Texture目录名称\recho !oldt!\recho ------新Texture目录名称\recho !newt!\recho ------Texture改名中...\rsvn mv !oldt! !newt!\r)\rpause\r一开始卡在变量这块很久，最后发现一定要有setlocal EnableDelayedExpansion，然后变量才可以在do()里用!oldm!这样，而不能用%oldm%\nset \u0026quot;newm=!oldm:Mesh=00_Mesh!\u0026quot;这行的操作是字符串替换，举例来说此时!oldm!为C:\\Users\\winte\\Desktop\\project\\Assets01\\Resource\\Mesh\n会将此段字符串中的Mesh替换为00_Mesh,得到\nC:\\Users\\winte\\Desktop\\project\\Assets01\\Resource\\00_Mesh\n然后是一些交互上的完善，有个用到的结构\n@echo off\recho 如需要撤销操作请按r,按其他任意键退出...\rset /p a=请输入r后回车:\rif \u0026quot;%a%\u0026quot;==\u0026quot;r\u0026quot; Goto abc\rexit /b\r:abc\r....\r这里有个判断，如果按下了r键，会触发Goto abc，然后跳转到:abc以下的脚本，否则会直接走exit /b退出脚本，很实用\n一些Tips\r将变量与批处理中的另一个变量的一部分匹配 https://www.thinbug.com/q/19056911\n测试这段是好用的，用来检测一段字符串是否含有一段字符串\n@echo off\rset \u0026quot;h=Hello-World\u0026quot;\rset \u0026quot;f=This is a Hello-World test\u0026quot;\rcall set \u0026quot;a=%%f:%h%=%%\u0026quot;\rif not \u0026quot;%a%\u0026quot;==\u0026quot;%f%\u0026quot; goto :done\rpause\rexit /b\r:done\recho it matched\rpause\r一个ping通隔段时间再ping，ping不通就关机的例子\nhttp://www.bathome.net/thread-12490-1-1.html @echo off\r:open\rping 192.168.1.90\rif %ERRORLEVEL%==0 goto Ok\rif %ERRORLEVEL%==1 goto No\rexit\r:No\rcls\u0026amp;echo 不通!关机操作\rshutdown -s -f -t 5000\r::5000秒后关机\rexit\r:Ok\rcls\u0026amp;echo.通，10分钟后再监测，请勿关闭本窗口\rping 127.0.1 /n 600 \u0026gt;nul\r::600秒后执行检测\rgoto open\r如果要检测的是上段脚本执行以后的返回值，可以用到%ERRORLEVEL% https://www.jianshu.com/p/5e72aed76b71\n不过%ERRORLEVEL%返回的是个数值，成功执行是0，不成功执行是非0，但是我用作svn命令执行判断的时候发现，有些指令即便不成功执行也返回0？懒得深究\n找到另外一种方法直接判断返回的字符串 https://blog.csdn.net/hadsdn/article/details/78957361\n","date":"2021-12-14T00:00:00Z","permalink":"http://localhost:10354/posts/bat/","title":"批处理实现批量改名以及SVN批量改名"},{"content":"\nJava服务器地址：mc.winotmk.com:25465\n基岩服务器地址：mc.winotmk.com:19132\n网站：\nWeb地图：http://mcmap.winotmk.com\n服务器概况\r目前版本：spigot-1.20.1\n自有服务器，计划长期开服，主世界不清档，视情况可以增加副世界\n使用了Geyser插件，实现基岩版和Java版本同服，支持多种客户端，可以在手机和电脑上同时玩 （主机也行没测过\n开服日期：2021-11-07\n容器化上云: 2023-08-25\n世界结构：\nLobby\nMainWorld -Nether -TheEnd\nLyhWorld\n现有传送门：\nLobby去塔顶 Lobby去主世界（主传送门） Lobby去lyh存档世界 主世界往返湖边村落 更新log\r2023-08-25\n版本由spigot-1.17.1更新至spigot-1.20.1 运行环境eci内运行，服务器文件nas上存储，环境和数据分离 服务器版本更新至1.20.1（顺带更新对应插件版本）\n禁用如下插件： PlaceholderAPI MiaoChat(被曝有后门) wolfyutilities ServerMinimap(似乎没啥用) Dynmap(web端地图，性能消耗巨大，体积巨大，暂移除) 常用玩家命令\r按T输入文本\n第一次进服务器需要注册\n/reg 密码 密码\r登录\n/l 密码\r回主城lobby\n/spawn\r回家（上次认得床）\n/home\r回上次移动的地方（或上次死的地方)\n/back\r移动到玩家身边（需要对方确认)\n/tpa 玩家名\r开始\r首先选择一个版本\n如果你买过Windows版、主机，iPad之类的版本，可以选择基岩版\n或者在windows和MAC上玩Java版\n附上Windows游戏购买链接\njava：https://www.minecraft.net/zh-hans/store/minecraft-java-edition\n基岩：https://www.minecraft.net/zh-hans/store/minecraft-windows10\nJava版连接服务器\r如果购买过正版java版本\r直接进多人游戏输入服务器地址mc.winotmk.com:25465即可\n如果没有购买\r这里提供原版纯净客户端：\n链接：https://pan.baidu.com/s/1dl3mBgqhmvxPGMNVG2bRgw\n提取码：lijt\n下载java运行环境\rhttps://www.oracle.com/java/technologies/downloads/#jdk17-windows\n下载客户端\r运行HMCL登陆器\n登录方式选离线模即可，写个名字，即游玩服务器时的名字\nps.如果启动失败请确保使用了java17\n进游戏选择\n第一次进服务器需要按T\n然后输入/reg 密码 密码\n注册\nenjoy！\n基岩版连接服务器\r启动游戏选服务器，添加服务器\n然后输入地址mc.winotmk.com端口19132\n服务器插件列表\r以下部分玩家有兴趣可看\n插件有功能类和玩法类多种，简单记录一下目前所有的插件\nActionHealth AncientGates AureliumSkills-Beta1.1.4 BlockLocker BossShopPro CatSeedLogin-1.3.9 Dynmap-3.2.1-spigot EssentialsX-2.19.0 EssentialsXChat-2.19.0 EssentialsXSpawn-2.19.0 Geyser-Spigot_基岩转发 GiftPack GSit LuckPerms-Bukkit-5.3.47 MiaoChat NekoMaid PocketGames Residence5.0.0.4 ServerMinimap Tree Feller-V2.2 Multiverse API前置类\nCMILib1.0.4.2_圈地前置 PlaceholderAPI-2.10.10 SmartInvs-1.2.7 Vault Uniporter-1.3.2_Web管理前置 wolfyutilities-1.7.2.0 ActionHealth\r在物品栏上显示血量\nhttps://www.spigotmc.org/resources/action-bar-health.2661/\nAncientGates\r传送门\n基础用法：\n本插件可以传送一切实体，包括玩家、运输工具、实体都能进入传送门\n这个插件不仅能跨服务器传送实体和输入指令，而且可以在进入另一个服务器时输入指令\n指令非常简单\n首先，需要输入指令打开功能：/gate setconf bungeeCordSupport true\n接下来你就可以使用任何关于BC的指令，创建传送门方法与普通的方法几乎无异\n/gate setto [id] [服务器] - 设置传送到的目的地\n/gate setbungeetype [id] [LOCATION/SERVER] - 在本地服务器上设置传送类型\n/gate addto [id] [服务器] - 添加传送到的服务器\n/gate remto [id] [服务器] - 删除可以传送到的服务器\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=584063\nAureliumSkills\r技能系统\n15 种独特的技能 (耕作Farming, 锻造Foraging, 挖矿Mining, 钓鱼Fishing, 采掘(旧版本翻译为掘土)Excavation, 箭术Archery, 防御Defense, 战斗Fighting, 耐力Endurance, 敏捷Agility, 炼金Alchemy, 附魔Enchanting, 巫术Sorcery, 治愈Healing, 以及锻造Forging) 6 种玩家属性 (生命Health, 力量Strength, 再生Regeneration, 幸运Luck, 智慧Wisdom, 以及韧性Toughness) 简洁明了, 能显示详细信息的 GUI 能够自定义物品和盔甲上的特殊属性 自定义打怪, 采集和钓鱼获得的特殊物品(掉落表/道具池, 原文为 Loot Table) 经验值来源及大小均可修改,Beta 1.1.1以后不再支持 MythicMobs 自定义怪物作为经验来源 多语言支持 ActionBar 与 BossBar 位置显示 可供开发者使用的 API 支持 MySQL /skills 或 /skill 或 /sk - 打开技能菜单,详见MCBBS\nMCbbs搬运：https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=1094927\nhttps://www.spigotmc.org/resources/aurelium-skills-advanced-skills-stats-abilities-and-more.81069/\nBlockLocker\r上锁插件\n使用方法\n1. 放置木牌\n对于容器类: 只需放置木牌即可,[私有]和玩家名会被自动生成.\n对于门类: 放置木牌在门上或周围的方块上即可,内容会自动生成.\n其他:你也可以自己添加锁定信息,按照生成木牌的格式填写即可~\n2.编辑木牌\n右击木牌,输入\u0026quot;/blocklocker \u0026lt;行数\u0026gt; \u0026lt;文本\u0026gt;\u0026ldquo;来编辑木牌.\n指令简写: \u0026ldquo;/bl\u0026rdquo; = \u0026ldquo;/blocklocker\u0026rdquo;,方法为: \u0026ldquo;/bl \u0026lt;行数\u0026gt; \u0026lt;文本\u0026gt;\u0026rdquo;.\n可添加其他字符来避免被识别为玩家名,例如 \u0026ldquo;~\u0026rdquo;.\n3.信任其他玩家\n在第二步的 \u0026lt;文本\u0026gt; 内容中添加你要信任的玩家名即可.\n如果想添加两个以上的玩家名,再放置一个木牌即可,内容会自动添加.\n第二个木牌添加内容 \u0026ldquo;‘[更多使用者]’ ‘[所有人]’\u0026rdquo;.\n\u0026ldquo;[所有人]\u0026ldquo;标签将允许所有人访问容器.请更改.\nMCbbs搬运：https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=1173296\nhttps://www.spigotmc.org/resources/blocklocker.3268/\nBossShopPro\r已移除\n商店系统\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=829068\n商店页面编辑器：https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=1273221\nCatSeedLogin\r种子猫登录插件\n基岩入口和java入口都关闭了正版验证，所以加了登录插件来管理玩家的账号，此插件备选可替换AuthMe\n登录\n/login 密码\n/l 密码\n注册密码\n/register 密码 重复密码\n/reg 密码 重复密码\n修改密码\n/changepassword 旧密码 新密码 重复新密码\n/changepw 旧密码 新密码 重复新密码\n绑定邮箱 /bindemail set 邮箱 /bdmail set 邮箱\n用邮箱收到的验证码完成绑定 /bindemail verify 验证码 /bdmail verify 验证码\n忘记密码，请求服务器给自己绑定的邮箱发送重置密码的验证码\n/resetpassword forget /repw forget\n用邮箱收到的验证码重置密码\n/resetpassword re 验证码 新密码\n/repw re 验证码 新密码\nMCBBS:https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=847859\nDynmap\r20230825更新：会消耗过多云服务资源暂移除\nWeb端卫星地图，还可3d显示，实时显示在线玩家位置，上帝视角\nMcbbs:https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=990539\nhttps://dynmap.us/builds/dynmap/\nEssentialsX\r系列管理插件\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=619883\nGeyser-Spigot\r该插件让基岩版玩家可以进入本服务器\nhttps://geysermc.org/\nhttps://www.mcbbs.net/thread-973002-1-1.html\nGiftPack\r已移除\n礼包插件\nhttps://www.mcbbs.net/thread-1141658-1-1.html\nGSit\r座椅子插件\n/gsit(/sit) 坐在方块上\n/glgy(/lay) 躺在方块上\n/gcrawl(/crawl) 趴在方块上\n/gsittoggle(/sittoggle) 开关右键坐下\n/gsitreload(/gsitrl) 重载插件配置\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=1107053\nhttps://www.spigotmc.org/resources/gsit-modern-sit-seat-and-chair-lay-and-crawl-plugin-1-13-x-1-17-x.62325/\nLuckPerms\r权限管理\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=676818\nhttps://www.spigotmc.org/resources/luckperms.28140/\nMiaoChat\r聊天功能增加\n20230825更新：移除，被曝有后台\n聊天的时候输出%数字，代表展示手上物品\n%1-9 代表快捷物品栏1-9号格子的物品\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=631240\nNekoMaid\rWed后台管理插件\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=1230139\nPocketGamesPo\r34+口袋游戏|随时随地想玩就玩\n玩家命令:\n/pocketgames|/pocket|/pg - 打开游戏菜单 /pg help - 打开插件帮助 /pg menu [玩家名] - 为指定玩家打开游戏菜单 /pg multiplayer [玩家名] - 为指定玩家打开多人游戏菜单 /pg spectate [玩家名] - 为指定玩家打开观战菜单 /pg play \u0026lt;游戏ID\u0026gt; [玩家名] - 让指定的玩家玩指定的游戏 /pg highscore \u0026lt;游戏ID\u0026gt; [玩家名] - 为指定玩家打开指定游戏的高分榜 /pg duel \u0026lt;a/d/玩家名\u0026gt; [游戏ID] - 接受邀请/拒绝邀请/邀请玩家进行多人游戏 /pg check \u0026lt;玩家名\u0026gt; - 检查玩家是否在玩游戏以及玩的什么游戏 /pg list - 插件的游戏列表 管理员命令:\n/pocketgamesadmin|/pga - 管理员帮助信息 /pga reset file \u0026lt;文件名\u0026gt; [只可填highscores.yml] /pga reset database [表] - 刷新数据库指定的表 /pga info - 插件信息 /pga reload - 重载插件 https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=913753\nResidence\r圈地插件\n/res ? —— 查看帮助\nhttps://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=631343\nServerminimap\r小地图\n20230825更新：似乎没啥用，移除\n/minimap - 为您提供小地图项目\n/waypoint help [command] - 为您提供有关此命令的信息\n/waypoint add [x] [z] - 在您当前的位置或指定的 x 和 z 坐标上添加一个航点。\n/waypoint list - 列出所有航点及其索引\n/waypoint remove - 删除索引为 的航点。注意：删除航点时，索引会发生变化。\n/waypoint hide [true|false] - 切换航点的可见性，或将其设置为给定的布尔值。\n/lp group admin permission set minimap.fastupdate\n/lp group admin permission set minimap.command.minimap\n/lp group admin permission set minimap.command.waypoint.help\n/lp group admin permission set minimap.command.waypoint.list\n/lp group admin permission set minimap.command.waypoint.add\n/lp group admin permission set minimap.command.waypoint.remove\n/lp group admin permission set minimap.command.waypoint.hide\nhttps://dev.bukkit.org/projects/serverminimap\nTree Feller\r一键砍树插件\nhttps://www.spigotmc.org/resources/tree-feller.92998/\nMultiverse\r多世界插件\n#命令语法\nmv [FILTER] [PAGE #]\n#发送版本信息至控制台\nmv version -[pbg]\n#列出所有世界名称\nmv list\n#列出综合信息\nmv info [WORLD] [PAGE]\n*/mv info [世界名称] [页码]\n#创建世界\nmv create {名字} {环境} -s [种子] -g [生成器[:ID]] -t [生成器] [-n] -a [true|false]\n#复制某个世界\nmv clone {目标} {名字} -g [生成器[:ID]]\n#转换某个世界的类型\nmv import {名字} {环境} -g [生成器[:ID]] [-n]\n#重新加载配置文件\nmv reload\n#重置当前世界的默认出生点为脚下\nmv setspawn\nmcbbs:https://www.mcbbs.net/forum.php?mod=viewthread\u0026amp;tid=1016455\nhttps://www.spigotmc.org/resources/multiverse-core.390/\n","date":"2021-11-07T00:00:00Z","image":"http://pictures.winotmk.com/MC/2025-02-27-23-58-20_41d3fcaa.png","permalink":"http://localhost:10354/posts/mc/","title":"SourceCraft服务器"},{"content":"参考文章：https://zhuanlan.zhihu.com/p/138951848\n官方WIKI安装指南（上文和本文大致流程基于此）：https://wiki.archlinux.org/title/Installation_guide\n家里旧笔记本淘汰装个Linux跑跑服务发挥余热，\n这里是彻底格式化硬盘新安装，而不需要多系统引导\n我的环境有：\n2核 Intel(R) Pentium(R) CPU 997 @ 1.60GHz 4GB 1600内存 UEFI启动（不能为BIOS） Samsang 850 EVO 250G 2.5寸SATA接口 无线网卡拆掉了，用得是网线 路由器上全局梯子（所以我没有换源，用官方源速度足够了） 准备镜像\rhttps://archlinux.org/download/\n下载发行版的Linux的ISO\n然后制作U盘启动，我是在mac下用balenaEtcher做的，操作非常方便\n然后重启电脑从U盘启动\n硬盘准备\r进入U盘系统后先连pacman试试\npacman -Syyy\r检查硬盘\rlsblk\r建立分区\rcfdisk /dev/sda\r选择New 回车，然后\n选择Write 回车 输入 yes 回车\n写入完成 选择Quit 回车退出\n格式化\r将刚刚分好的区格式化为ext4格式，这里认准分区号sda1\nmkfs.ext4 /dev/sda1\r挂载分区\rsda1\nmount /dev/sda1 /mnt\r安装系统\rpacstrap /mnt base linux linux-firmware nano\r生成fstab文件\rgenfstab -U /mnt \u0026gt;\u0026gt; /mnt/etc/fstab\r检查生成的fstab文件\ncat /mnt/etc/fstab\r配置新系统\r切换到装好的系统\rarch-chroot /mnt\r设置时区\rln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\r设置locale\rnano /etc/locale.gen\rCtrl+W 输入 #en_US 回车 找到UTF-8那一行 删掉前面的#\nCtrl+W 输入 #zh_CN 回车 找到UTF-8那一行 删掉前面的#\nCtrl+X 然后Y保存退出\n生成locale\nlocale-gen\r创建并写入/etc/locale.conf文件\nnano /etc/locale.conf 填入内容，注意这里只能填这个\nLANG=en_US.UTF-8\r创建并写入hostname\rnano /etc/hostname\r我这里名字叫WinArch\n保存退出\n修改hosts\rnano /etc/hosts\r写入内容如图（中间的空白用tab而非空格），arch替换为你之前在hostname里写入的内容，其他都按照图里面的写（注意最后一行的ip是127.0.1.1）\n保存退出\n建议上述编辑的内容都用cat输出检查一下\nroot用户创建密码\rpasswd\r然后输入并确认密码\n装启动器和一些软件\r包含了一些常用到的软件\npacman -S grub efibootmgr networkmanager network-manager-applet dialog wireless_tools wpa_supplicant os-prober mtools dosfstools ntfs-3g base-devel linux-headers reflector git sudo\rintel的cpu，需要安装intel的微码文件\npacman -S intel-ucode\r完成之后输入\ngrub-install /dev/sda\r注意是硬盘位置不是分区位置，硬盘上也只有刚刚安装的Arch系统\n生成grub.cfg\ngrub-mkconfig -o /boot/grub/grub.cfg\r出现吧啦吧啦done就完成了\n退出新系统重启\rexit\rreboot\r不装桌面环境的话，到这步即可使用了，后续需要什么再装不迟\n新建用户并授权\ruseradd -m -G wheel winotmk\r我的用户是winotkm，这里主要是创建一个非root的账户，桌面环境一般无法用root登陆的\n创建密码\npasswd winotmk\r授权\nEDITOR=nano visudo\rCtrl+W 输入 # %wheel 回车 找到这行 删除前面的 #（取消注释）\n安装Display Server和Display Manager\rpacman -S xorg\r然后我喜欢KDE桌面，所以装：\npacman -S sddm\r设置开机启动\nsystemctl enable sddm\rPS.取消开机启动是\nsystemctl disable sddm\r安装Desktop Environment\rKDE：\npacman -S plasma kde-applications packagekit-qt5\r安装中文的字体\npacman -S noto-fonts-cjk\r好了，大功告成\nreboot\r","date":"2021-10-25T00:00:00Z","permalink":"http://localhost:10354/posts/%E5%AE%89%E8%A3%85arch/","title":"安装ArchLinux系统（详细过程）"},{"content":"刚装完archlinux后ifconfig无法使用?\n# pacman -S net-tools dnsutils inetutils iproute2\rArchlinux开启ssh服务命令：\r# systemctl enable sshd.service 开机启动\r# systemctl start sshd.service 立即启动\r# systemctl restart sshd.service 立即重启\r关于systemctl:\rhttps://wiki.archlinux.org/title/Systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\n比如：关闭开机启用KDE桌面环境\n# systemctl disable sddm\r切换到root用户：\r# su\r以下无用，应该是旧版本PuTTY密钥算法支持有限，请更新PuTTY。。\n用PuTTY登录报错：\ncouldn\u0026rsquo;t agree a host key algorithm\n解决，生成密钥：（出处：https://forums.centos.org/viewtopic.php?t=52892\n# cd /etc/ssh\r# ssh-keygen -t dsa -f /etc/ssh/ssh_host_dsa_key\r# vi /etc/ssh/sshd_config\rUncomment this line:\r# HostKey /etc/ssh/ssh_host_dsa_key\r# chgrp ssh_keys ssh_host_dsa_key\r# service sshd restart\r如果putty连接报Network error:connection refused\n关闭防火墙\n# systemctl start iptables\r安装jre环境\r# pacman -S jre8-openjdk\r高版本mc需要高JDK\n# pacman -S jre17-openjdk\r切换java版本\n# sudo archlinux-java set java-17-openjdk\r查看java状态\n# java -version\r启动一个mc服务器\rhttps://cloud.tencent.com/developer/article/1622545\n# java -Xms1024MB -Xmx2048MB -jar iserver.jar\r设置中文环境\r# vim /etc/locale.conf\r增加以下内容\nLANG=zh_CN.UTF-8\n下次重新登录就是中文啦。可以输入date查看日期，如果显示中文，就说明设置正常啦\n关于linux任务前后台处理：\rhttps://blog.csdn.net/timonium/article/details/116245621\nhttps://www.cnblogs.com/xiaoleiel/p/8349675.html\n正在前台运行的命令暂停且放到后台：\n# Ctrl+z\r# jobs ## 查看后台进程编号\r# jobs -l ##查看进程PID，可以配合kill干掉进程\rbg在后台继续执行，fg调回前台执行\n# bg [作业编号]\r# fg [作业编号]\r一开始就后台执行：\nhttps://www.cnblogs.com/linnuo/p/9084125.html\n# java -jar shareniu.jar \u0026amp;\r\u0026amp;代表在后台运行\n# nohup java -jar shareniu.jar \u0026amp;\rnohup 意思是不挂断运行命令,当账户退出或终端关闭时,程序仍然运行\n当用 nohup 命令执行作业时，缺省情况下该作业的所有输出被重定向到nohup.out的文件中，除非另外指定了输出文件。\nps：我觉得上面的后台操作不好用不如试试Screen\nhttps://blog.csdn.net/han0373/article/details/81352663\nscreen -S yourname -\u0026gt; 新建一个叫yourname的session\nscreen -ls -\u0026gt; 列出当前所有的session\nscreen -r yourname -\u0026gt; 回到yourname这个session\nscreen -d yourname -\u0026gt; 远程detach某个session\nscreen -d -r yourname -\u0026gt; 结束当前session并回到yourname这个session\n回到MCSManager的面板\n# screen -r mcsm\r看进程\r# ps aux\r或者\r# top\r压缩\rhttps://www.jianshu.com/p/59d93f942506\n01-.tar格式\r解包：# tar xvf FileName.tar\r打包：# tar cvf FileName.tar DirName（注：tar是打包，不是压缩！）\r02-.gz格式\r解压1：# gunzip FileName.gz\r解压2：# gzip -d FileName.gz\r压 缩：# gzip FileName\r03-.tar.gz格式\r解压：# tar zxvf FileName.tar.gz\r压缩：# tar zcvf FileName.tar.gz DirName\r","date":"2021-10-24T00:00:00Z","permalink":"http://localhost:10354/posts/archlinux%E5%91%BD%E4%BB%A4/","title":"ArchLinux命令集"},{"content":"*本文摘录整理为主\n用ls -l查看权限：\n文件属性 文件数 拥有者 所属的group 文件大小 建档日期 文件名　drwx--x--x 1 root wheel 6872 2 7 22:41 compressedPackage/ drwxr-xr-x 1 liuml wheel 8620 2 15 09:32 wwwroot/　lrwxrwxrwx 1 liuml wheel 46 2 24 19:30 abc@ -\u0026gt; home/abc -rwxr-xr-x 1 liuml wheel 68568 2 29 07:43 test*　- 文件名栏位 文件后面的符号含义 - / ：表明是一个目录 - @ ：表明是到其它文件的符号链接 - * ：表明是一个可执行文件。 - 对于权限设置的解释 - r 是读，w 是写，x 是执行 - 对应数字如下: - r = 4 w = 2 x = 1 - rwx ：4+2+1 = 7 - rw- ：4+2 = 6 - r-x ：4+1 = 5 - drwxr-xr-x ：755 - 第 0-1位 文件类型 - “-” ：表示普通文件； - “d” ：表示目录； - “l” ：表示链接文件； - “p” ：表示管理文件； - “b” ：表示块设备文件； - “c” ：表示字符设备文件； - “s” ：表示套接字文件； - 第 2-4位 文件所有者权限 [User] - 第 5-7位 文件所有者所在组权限 [Group] - 第 8-10位 其他用户权限 [Others] - 没有的权限用 “-” 来表示 ———————————————— 版权声明：本文为CSDN博主「烟雨弥漫了江南」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。 原文链接：https://blog.csdn.net/u010324331/article/details/88035175/ 图片来源：https://blog.csdn.net/zhuoya_/article/details/77418413\n共显示了七列信息，从左至右依次为：权限、文件数、归属用户、归属群组、文件大小、创建日期、文件名称\nd ：第一位表示文件类型\n第一位字符 文件类型 d 文件夹 - 普通文件 l 链接 b 块设备文件 p 管道文件 c 字符设备文件 s 套接口文件 rxw和数值权限的对应：\nrxw 数值 r(读) 4 w(写) 2 x(执行) 1 所以，例如：\nrwx rw- r\u0026ndash;\n7 6 4\n三个一组,rwx权限分别对应421相加得7,rw-对应42相加,r\u0026ndash;对应4\n图片来源：http://man.linuxde.net/chmod\n举例：-rw-r\u0026ndash;r\u0026ndash;，即为644权限\n6对应4+2 rw-\n4对应 r\u0026ndash;\n那么这个文件的权限就是所有者rw-,所属组r\u0026ndash;,其他人r\u0026ndash;\n常用的linux权限对应：\n数值 rxw 444 r\u0026ndash;r\u0026ndash;r\u0026ndash; 600 rw\u0026mdash;\u0026mdash;- 644 rw-r\u0026ndash;r\u0026ndash; 666 rw-rw-rw- 700 rwx\u0026mdash;\u0026mdash; 744 rwxr\u0026ndash;r\u0026ndash; 755 rwxr-xr-x 777 rwxrwxrwx 命令修改权限\r权限管理命令chmod 修改文件或者目录的权限\n全拼: change permissions mode of a file\n语法:\nchmod [{ugoa}{+-=}{rwx}] [文件或目录] [mode=421] [文件或目录] -R 递归修改 u:所有者, g:所属组,o:其他人,a:所有; +:添加权限,-减少权限,=直接赋值成这个权限 创建目录mkdir时加权限 $ mkdir -m=r-- letter 上面的命令会创建一个名为 letter 的目录，同时为目录所有者、用户组和其他用户 针对该目录赋予只读权限\nmkdir命令小参考：在 Linux 下用 mkdir 命令来创建目录和子目录\n参考：\rlinux权限drwxrwxrwx所代表的意义\nlinux ls -l命令显示详解\nlinux更改文件(夹)权限或所有者\nLinux 文件权限查看及修改\n","date":"2021-10-24T00:00:00Z","permalink":"http://localhost:10354/posts/linux%E6%9D%83%E9%99%90/","title":"linux文件和目录权限"},{"content":"\n命令\r前半参考：\n从此Mac上的文件再也不会丟了\n后半参考：\n如何自己搭建一个Time Machine服务器\n挂载硬盘目录\nsudo mount /dev/sda2 /mnt/WinSource 1.安装netatalk和avahi（自己感觉avahi不装也行\nsudo apt install netatalk avahi-daemon -y 2.创建账户wintm来访问TimeMachine，至少别用root，root访问不能！\nuseradd -c \u0026quot;Time machine\u0026quot; -m -s /bin/bash wintm 然后设置密码\nsudo passwd wintm 3.配置netatalk\nsudo nano /etc/netatalk/AppleVolumes.default 这个文件似乎一行代表一个服务\n可以在\n# The line below sets some DEFAULT, starting with Netatalk 2.1. :DEFAULT: options:upriv,usedots # By default all users have access to their home directories. ~/\t\u0026quot;Home Directory\u0026quot; 下面加上一行\n/mnt/WinSource/TimeMachine WinMachine allow:wintm options:tm #挂在硬盘里的文件夹 afp服务名 允许wintm用户登陆 开启timemachine 4.重启服务\nsudo service netatalk restart sudo service avahi-daemon restart 一些坑\r试图直接使用root账户连接，在这里卡了很久，还尝试在AppleVolumes.default设置里写上例如 /mnt/WinSource/TimeMachine WinMachine allow:root rwlist:root options:tm\n翻到这篇：[NAS之旅]-基于Centos7搭建Netatalk为Windows增加AFP协议\n才忽然醒悟，root用户是禁止登录AFP服务的，得嘞，新开个专门的用户吧\n提到了新建一个用户来跑timemachine：如何自己搭建一个Time Machine服务器\n一开始习惯将硬盘挂载到/root/WinSource，然鹅这似乎导致即便mac上TimeMachine连接上了也报错没法开始备份，想想也是wintm用户没有权限进root。。总结为避免不必要的麻烦以后硬盘不挂/root里，这里我挂进了/mnt ps:当时还试图对/root/WinSource使用chown\nsudo chown -R wintm:wintm /root/WinSource 见这篇：用树莓派实现 Time Capsule\n无解，chown改不了WinSource目录的所有者，root强而有力，认输\n补充连接\rNetaTalk官方文档和下载：http://netatalk.sourceforge.net/3.1/htmldocs/afp.conf.5.html\nAFP Netatalk 分享配置 (又名 Apple Time Machine).\n使用netatalk打造一款属于自己的Time-Machine在线备份服务器\n","date":"2021-10-14T00:00:00Z","image":"http://pictures.winotmk.com/%E6%A0%91%E8%8E%93%E6%B4%BETimeMachine/2025-02-27-23-44-08_12ebde84.png","permalink":"http://localhost:10354/posts/%E6%A0%91%E8%8E%93%E6%B4%BEtimemachine/","title":"树莓派上架设TimeMachine服务"},{"content":"https://winotmk.github.io/\ngithub：https://github.com/winotmk/winotmk.github.io\n总有一些零碎的想法，需要记录下来，写全面的文章没有时间，不写下来又会忘，日记app又不方便整理，同时也想利用一下树莓派，网上搜索便发现hexo+github部署的方式，于是想尝试尝试，一路遇到很多问题\n主要参考：基于树莓派搭建Hexo博客部署到GitHub/Gitee\n前期第二参考：hexo——轻量、简易、高逼格的博客\n更详细的安装过程：GitHub+Hexo 搭建个人网站详细教程\nhexo官方文档：https://hexo.io/docs/\nhexo博客文档（似乎和上面有不少内容重叠）：https://theme-next.js.org/docs/\n安装hexo\r下载armv7版本的node.js：nodejs下载\n配置github\rgit key配置：github每次需要输入密码和用户名的问题\u0026hellip;\n取消使用key令牌后还要输入密码：取消 SSH 私钥密码\n后期配置\rhexo配置\r官方文档：https://hexo.io/zh-cn/docs/configuration\n主题\rNext主题github：https://github.com/next-theme/hexo-theme-next\nNext主题的文档(ps.页面样式好看可参考)：第三方服务集成\nNext主题代码框高亮预览设置：https://theme-next.js.org/highlight/\n资产文件夹\rhttps://hexo.io/docs/asset-folders\n访客统计\rDevOps 访客数统计 \u0026amp; google analytics 数据分析\n将文章视图添加到您的 Hexo 博客(有LeanCloud和Firebase比较分析）\n给hexo博客文章添加阅读次数统计\nhexo next主题的leancloud安全插件github：https://github.com/theme-nex\u0026hellip;\n上面链接的说明：Leancloud访客统计插件重大安全漏洞修复指南\nFirebase:https://console.firebase.google\u0026hellip;\n评论\r畅言：https://changyan.kuaizhan.com/v3/changyan/overview\nvaline：https://valine.js.org\n其他\r配置vscode：\r本来都是用putty打指令，用WinSCP访问我的目录操作的，但是WinSCP自带的文本编辑过与拉跨，有几次多打空格没看出来导致直接hexo g失败，后来突发奇想为啥不找个轻量级的IDE直接去写这些呢，于是用起了vscode\nVscode配置ftp连接远程服务器（上传本地文件）\n不过自己测试发现不好用，于是用了SSH FS这个vscode插件\n相对路径./与../区别\n","date":"2021-10-13T00:00:00Z","permalink":"http://localhost:10354/posts/hexo+github/","title":"hexo+github"},{"content":"\n","date":"2021-10-13T00:00:00Z","permalink":"http://localhost:10354/posts/maya_mash/","title":"MayaMASH动力学做链子"}]